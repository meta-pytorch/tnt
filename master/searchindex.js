Search.setIndex({"docnames": ["checkpointing", "distributed", "examples", "framework/auto_unit", "framework/callbacks", "framework/eval", "framework/fit", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter", "framework/generated/torchtnt.framework.callbacks.EarlyStopping", "framework/generated/torchtnt.framework.callbacks.GarbageCollector", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger", "framework/generated/torchtnt.framework.callbacks.Lambda", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot", "framework/generated/torchtnt.framework.callbacks.ModuleSummary", "framework/generated/torchtnt.framework.callbacks.PeriodicDistributedSync", "framework/generated/torchtnt.framework.callbacks.ProgressReporter", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler", "framework/generated/torchtnt.framework.callbacks.SlowRankDetector", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor", "framework/generated/torchtnt.framework.callbacks.ThroughputLogger", "framework/generated/torchtnt.framework.callbacks.TimeLimitInterrupter", "framework/generated/torchtnt.framework.callbacks.TimeWaitForBatchLogger", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor", "framework/predict", "framework/state", "framework/train", "framework/unit", "index", "overview", "utils/generated/torchtnt.utils.data.AbstractRandomDataset", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher", "utils/generated/torchtnt.utils.data.InOrderIterator", "utils/generated/torchtnt.utils.data.MultiDataLoader", "utils/generated/torchtnt.utils.data.MultiIterator", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator", "utils/generated/torchtnt.utils.data.RoundRobinIterator", "utils/generated/torchtnt.utils.device.copy_data_to_device", "utils/generated/torchtnt.utils.device.get_device_from_env", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats", "utils/generated/torchtnt.utils.device.record_data_in_stream", "utils/generated/torchtnt.utils.device.set_float32_precision", "utils/generated/torchtnt.utils.distributed.PGWrapper", "utils/generated/torchtnt.utils.distributed.all_gather_tensors", "utils/generated/torchtnt.utils.distributed.barrier", "utils/generated/torchtnt.utils.distributed.destroy_process_group", "utils/generated/torchtnt.utils.distributed.get_file_init_method", "utils/generated/torchtnt.utils.distributed.get_global_rank", "utils/generated/torchtnt.utils.distributed.get_local_rank", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method", "utils/generated/torchtnt.utils.distributed.get_world_size", "utils/generated/torchtnt.utils.distributed.rank_zero_fn", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm", "utils/generated/torchtnt.utils.distributed.spawn_multi_process", "utils/generated/torchtnt.utils.distributed.sync_bool", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker", "utils/generated/torchtnt.utils.env.init_from_env", "utils/generated/torchtnt.utils.env.seed", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode", "utils/generated/torchtnt.utils.fsspec.get_filesystem", "utils/generated/torchtnt.utils.loggers.CSVLogger", "utils/generated/torchtnt.utils.loggers.FileLogger", "utils/generated/torchtnt.utils.loggers.InMemoryLogger", "utils/generated/torchtnt.utils.loggers.JSONLogger", "utils/generated/torchtnt.utils.loggers.MetricLogger", "utils/generated/torchtnt.utils.loggers.StdoutLogger", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger", "utils/generated/torchtnt.utils.memory.RSSProfiler", "utils/generated/torchtnt.utils.memory.measure_rss_deltas", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "utils/generated/torchtnt.utils.misc.days_to_secs", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats", "utils/generated/torchtnt.utils.module_summary.ModuleSummary", "utils/generated/torchtnt.utils.module_summary.get_module_summary", "utils/generated/torchtnt.utils.module_summary.get_summary_table", "utils/generated/torchtnt.utils.module_summary.prune_module_summary", "utils/generated/torchtnt.utils.oom.attach_oom_observer", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error", "utils/generated/torchtnt.utils.oom.log_memory_snapshot", "utils/generated/torchtnt.utils.optimizer.init_optim_state", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp", "utils/generated/torchtnt.utils.prepare_module.prepare_module", "utils/generated/torchtnt.utils.progress.Progress", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn", "utils/generated/torchtnt.utils.stateful.MultiStateful", "utils/generated/torchtnt.utils.stateful.Stateful", "utils/generated/torchtnt.utils.swa.AveragedModel", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config", "utils/generated/torchtnt.utils.test_utils.is_asan", "utils/generated/torchtnt.utils.test_utils.is_tsan", "utils/generated/torchtnt.utils.test_utils.skip_if_asan", "utils/generated/torchtnt.utils.timer.BoundedTimer", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer", "utils/generated/torchtnt.utils.timer.Timer", "utils/generated/torchtnt.utils.timer.TimerProtocol", "utils/generated/torchtnt.utils.timer.get_durations_histogram", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram", "utils/generated/torchtnt.utils.timer.get_timer_summary", "utils/generated/torchtnt.utils.timer.log_elapsed_time", "utils/generated/torchtnt.utils.tqdm.close_progress_bar", "utils/generated/torchtnt.utils.tqdm.create_progress_bar", "utils/generated/torchtnt.utils.tqdm.update_progress_bar", "utils/generated/torchtnt.utils.version.get_python_version", "utils/generated/torchtnt.utils.version.get_torch_version", "utils/generated/torchtnt.utils.version.is_windows", "utils/utils"], "filenames": ["checkpointing.rst", "distributed.rst", "examples.rst", "framework/auto_unit.rst", "framework/callbacks.rst", "framework/eval.rst", "framework/fit.rst", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter.rst", "framework/generated/torchtnt.framework.callbacks.EarlyStopping.rst", "framework/generated/torchtnt.framework.callbacks.GarbageCollector.rst", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger.rst", "framework/generated/torchtnt.framework.callbacks.Lambda.rst", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor.rst", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot.rst", "framework/generated/torchtnt.framework.callbacks.ModuleSummary.rst", "framework/generated/torchtnt.framework.callbacks.PeriodicDistributedSync.rst", "framework/generated/torchtnt.framework.callbacks.ProgressReporter.rst", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler.rst", "framework/generated/torchtnt.framework.callbacks.SlowRankDetector.rst", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar.rst", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor.rst", "framework/generated/torchtnt.framework.callbacks.ThroughputLogger.rst", "framework/generated/torchtnt.framework.callbacks.TimeLimitInterrupter.rst", "framework/generated/torchtnt.framework.callbacks.TimeWaitForBatchLogger.rst", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver.rst", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor.rst", "framework/predict.rst", "framework/state.rst", "framework/train.rst", "framework/unit.rst", "index.rst", "overview.rst", "utils/generated/torchtnt.utils.data.AbstractRandomDataset.rst", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator.rst", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher.rst", "utils/generated/torchtnt.utils.data.InOrderIterator.rst", "utils/generated/torchtnt.utils.data.MultiDataLoader.rst", "utils/generated/torchtnt.utils.data.MultiIterator.rst", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator.rst", "utils/generated/torchtnt.utils.data.RoundRobinIterator.rst", "utils/generated/torchtnt.utils.device.copy_data_to_device.rst", "utils/generated/torchtnt.utils.device.get_device_from_env.rst", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats.rst", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats.rst", "utils/generated/torchtnt.utils.device.record_data_in_stream.rst", "utils/generated/torchtnt.utils.device.set_float32_precision.rst", "utils/generated/torchtnt.utils.distributed.PGWrapper.rst", "utils/generated/torchtnt.utils.distributed.all_gather_tensors.rst", "utils/generated/torchtnt.utils.distributed.barrier.rst", "utils/generated/torchtnt.utils.distributed.destroy_process_group.rst", "utils/generated/torchtnt.utils.distributed.get_file_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_global_rank.rst", "utils/generated/torchtnt.utils.distributed.get_local_rank.rst", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device.rst", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_world_size.rst", "utils/generated/torchtnt.utils.distributed.rank_zero_fn.rst", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm.rst", "utils/generated/torchtnt.utils.distributed.spawn_multi_process.rst", "utils/generated/torchtnt.utils.distributed.sync_bool.rst", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker.rst", "utils/generated/torchtnt.utils.env.init_from_env.rst", "utils/generated/torchtnt.utils.env.seed.rst", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode.rst", "utils/generated/torchtnt.utils.fsspec.get_filesystem.rst", "utils/generated/torchtnt.utils.loggers.CSVLogger.rst", "utils/generated/torchtnt.utils.loggers.FileLogger.rst", "utils/generated/torchtnt.utils.loggers.InMemoryLogger.rst", "utils/generated/torchtnt.utils.loggers.JSONLogger.rst", "utils/generated/torchtnt.utils.loggers.MetricLogger.rst", "utils/generated/torchtnt.utils.loggers.StdoutLogger.rst", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger.rst", "utils/generated/torchtnt.utils.memory.RSSProfiler.rst", "utils/generated/torchtnt.utils.memory.measure_rss_deltas.rst", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler.rst", "utils/generated/torchtnt.utils.misc.days_to_secs.rst", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats.rst", "utils/generated/torchtnt.utils.module_summary.ModuleSummary.rst", "utils/generated/torchtnt.utils.module_summary.get_module_summary.rst", "utils/generated/torchtnt.utils.module_summary.get_summary_table.rst", "utils/generated/torchtnt.utils.module_summary.prune_module_summary.rst", "utils/generated/torchtnt.utils.oom.attach_oom_observer.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error.rst", "utils/generated/torchtnt.utils.oom.log_memory_snapshot.rst", "utils/generated/torchtnt.utils.optimizer.init_optim_state.rst", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype.rst", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_module.rst", "utils/generated/torchtnt.utils.progress.Progress.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn.rst", "utils/generated/torchtnt.utils.stateful.MultiStateful.rst", "utils/generated/torchtnt.utils.stateful.Stateful.rst", "utils/generated/torchtnt.utils.swa.AveragedModel.rst", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config.rst", "utils/generated/torchtnt.utils.test_utils.is_asan.rst", "utils/generated/torchtnt.utils.test_utils.is_tsan.rst", "utils/generated/torchtnt.utils.test_utils.skip_if_asan.rst", "utils/generated/torchtnt.utils.timer.BoundedTimer.rst", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer.rst", "utils/generated/torchtnt.utils.timer.Timer.rst", "utils/generated/torchtnt.utils.timer.TimerProtocol.rst", "utils/generated/torchtnt.utils.timer.get_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table.rst", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram.rst", "utils/generated/torchtnt.utils.timer.get_timer_summary.rst", "utils/generated/torchtnt.utils.timer.log_elapsed_time.rst", "utils/generated/torchtnt.utils.tqdm.close_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.create_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.update_progress_bar.rst", "utils/generated/torchtnt.utils.version.get_python_version.rst", "utils/generated/torchtnt.utils.version.get_torch_version.rst", "utils/generated/torchtnt.utils.version.is_windows.rst", "utils/utils.rst"], "titles": ["Checkpointing", "Distributed training", "Examples", "AutoUnit", "Callbacks", "Evaluate", "Fit", "BaseCSVWriter", "EarlyStopping", "GarbageCollector", "IterationTimeLogger", "Lambda", "LearningRateMonitor", "MemorySnapshot", "ModuleSummary", "PeriodicDistributedSync", "ProgressReporter", "PyTorchProfiler", "SlowRankDetector", "SystemResourcesMonitor", "TQDMProgressBar", "TensorBoardParameterMonitor", "ThroughputLogger", "TimeLimitInterrupter", "TimeWaitForBatchLogger", "TorchSnapshotSaver", "TrainProgressMonitor", "Predict", "State", "Train", "Unit", "Welcome to the TorchTNT documentation!", "Overview", "torchtnt.utils.data.AbstractRandomDataset", "torchtnt.utils.data.AllDatasetBatchesIterator", "torchtnt.utils.data.CudaDataPrefetcher", "torchtnt.utils.data.InOrderIterator", "torchtnt.utils.data.MultiDataLoader", "torchtnt.utils.data.MultiIterator", "torchtnt.utils.data.RandomizedBatchSamplerIterator", "torchtnt.utils.data.RoundRobinIterator", "torchtnt.utils.device.copy_data_to_device", "torchtnt.utils.device.get_device_from_env", "torchtnt.utils.device.get_nvidia_smi_gpu_stats", "torchtnt.utils.device.get_psutil_cpu_stats", "torchtnt.utils.device.record_data_in_stream", "torchtnt.utils.device.set_float32_precision", "torchtnt.utils.distributed.PGWrapper", "torchtnt.utils.distributed.all_gather_tensors", "torchtnt.utils.distributed.barrier", "torchtnt.utils.distributed.destroy_process_group", "torchtnt.utils.distributed.get_file_init_method", "torchtnt.utils.distributed.get_global_rank", "torchtnt.utils.distributed.get_local_rank", "torchtnt.utils.distributed.get_process_group_backend_from_device", "torchtnt.utils.distributed.get_tcp_init_method", "torchtnt.utils.distributed.get_world_size", "torchtnt.utils.distributed.rank_zero_fn", "torchtnt.utils.distributed.revert_sync_batchnorm", "torchtnt.utils.distributed.spawn_multi_process", "torchtnt.utils.distributed.sync_bool", "torchtnt.utils.early_stop_checker.EarlyStopChecker", "torchtnt.utils.env.init_from_env", "torchtnt.utils.env.seed", "torchtnt.utils.flops.FlopTensorDispatchMode", "torchtnt.utils.fsspec.get_filesystem", "torchtnt.utils.loggers.CSVLogger", "torchtnt.utils.loggers.FileLogger", "torchtnt.utils.loggers.InMemoryLogger", "torchtnt.utils.loggers.JSONLogger", "torchtnt.utils.loggers.MetricLogger", "torchtnt.utils.loggers.StdoutLogger", "torchtnt.utils.loggers.TensorBoardLogger", "torchtnt.utils.memory.RSSProfiler", "torchtnt.utils.memory.measure_rss_deltas", "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "torchtnt.utils.misc.days_to_secs", "torchtnt.utils.misc.transfer_batch_norm_stats", "torchtnt.utils.module_summary.ModuleSummary", "torchtnt.utils.module_summary.get_module_summary", "torchtnt.utils.module_summary.get_summary_table", "torchtnt.utils.module_summary.prune_module_summary", "torchtnt.utils.oom.attach_oom_observer", "torchtnt.utils.oom.is_out_of_cpu_memory", "torchtnt.utils.oom.is_out_of_cuda_memory", "torchtnt.utils.oom.is_out_of_memory_error", "torchtnt.utils.oom.log_memory_snapshot", "torchtnt.utils.optimizer.init_optim_state", "torchtnt.utils.precision.convert_precision_str_to_dtype", "torchtnt.utils.prepare_module.DDPStrategy", "torchtnt.utils.prepare_module.FSDPStrategy", "torchtnt.utils.prepare_module.convert_str_to_strategy", "torchtnt.utils.prepare_module.prepare_ddp", "torchtnt.utils.prepare_module.prepare_fsdp", "torchtnt.utils.prepare_module.prepare_module", "torchtnt.utils.progress.Progress", "torchtnt.utils.progress.estimated_steps_in_epoch", "torchtnt.utils.progress.estimated_steps_in_fit", "torchtnt.utils.progress.estimated_steps_in_loop", "torchtnt.utils.rank_zero_log.rank_zero_critical", "torchtnt.utils.rank_zero_log.rank_zero_debug", "torchtnt.utils.rank_zero_log.rank_zero_error", "torchtnt.utils.rank_zero_log.rank_zero_info", "torchtnt.utils.rank_zero_log.rank_zero_print", "torchtnt.utils.rank_zero_log.rank_zero_warn", "torchtnt.utils.stateful.MultiStateful", "torchtnt.utils.stateful.Stateful", "torchtnt.utils.swa.AveragedModel", "torchtnt.utils.test_utils.get_pet_launch_config", "torchtnt.utils.test_utils.is_asan", "torchtnt.utils.test_utils.is_tsan", "torchtnt.utils.test_utils.skip_if_asan", "torchtnt.utils.timer.BoundedTimer", "torchtnt.utils.timer.FullSyncPeriodicTimer", "torchtnt.utils.timer.Timer", "torchtnt.utils.timer.TimerProtocol", "torchtnt.utils.timer.get_durations_histogram", "torchtnt.utils.timer.get_recorded_durations_table", "torchtnt.utils.timer.get_synced_durations_histogram", "torchtnt.utils.timer.get_synced_timer_histogram", "torchtnt.utils.timer.get_timer_summary", "torchtnt.utils.timer.log_elapsed_time", "torchtnt.utils.tqdm.close_progress_bar", "torchtnt.utils.tqdm.create_progress_bar", "torchtnt.utils.tqdm.update_progress_bar", "torchtnt.utils.version.get_python_version", "torchtnt.utils.version.get_torch_version", "torchtnt.utils.version.is_windows", "Utils"], "terms": {"torchtnt": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 32], "offer": [0, 1, 3, 4, 25, 30, 32], "via": [0, 3, 40], "distributedcheckpointsav": 0, "which": [0, 1, 3, 4, 5, 6, 10, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 35, 37, 41, 45, 46, 58, 60, 61, 74, 75, 92, 93, 94, 112, 114, 120], "us": [0, 1, 2, 3, 4, 5, 6, 8, 13, 14, 15, 16, 17, 18, 22, 23, 25, 27, 28, 29, 30, 32, 35, 39, 41, 44, 45, 46, 47, 49, 51, 52, 53, 55, 56, 57, 59, 60, 62, 63, 65, 72, 79, 87, 91, 94, 107, 118, 119, 123, 128], "dcp": 0, "under": [0, 25, 30], "hood": 0, "modul": [0, 1, 3, 5, 6, 14, 21, 27, 29, 30, 31, 32, 58, 63, 64, 77, 78, 79, 81, 90, 92, 93, 94, 105, 107], "nn": [0, 1, 3, 30, 32, 58, 92, 93, 105], "linear": [0, 1, 32, 58, 92, 93], "input_dim": [0, 1], "1": [0, 1, 6, 8, 9, 10, 18, 20, 22, 23, 24, 32, 34, 35, 36, 39, 40, 56, 57, 60, 61, 63, 64, 71, 79, 80, 81, 92, 93, 126], "unit": [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 31, 32], "myunit": [0, 11, 30, 32], "dirpath": [0, 25], "your_dirpath_her": 0, "save_every_n_train_step": [0, 25], "100": [0, 18, 33, 58, 66, 69, 116, 118, 119], "save_every_n_epoch": [0, 25], "2": [0, 3, 23, 34, 35, 36, 39, 40, 60, 63, 71, 80], "load": [0, 1, 3, 25, 35, 87, 106], "latest": [0, 31], "exist": [0, 25, 87], "latest_checkpoint_dir": 0, "restore_from_latest": 0, "train_dataload": [0, 4, 6, 25, 29, 32, 97], "dataload": [0, 3, 4, 5, 6, 11, 25, 27, 28, 29, 30, 32, 34, 35, 36, 37, 38, 39, 40, 75, 96, 98, 123], "train": [0, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31, 72, 75, 97, 108, 113, 128], "callback": [0, 1, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 31], "There": [0, 25, 32], "built": [0, 32], "support": [0, 3, 15, 25, 34, 36, 37, 38, 40, 42, 60, 79], "save": [0, 7, 13, 25, 30, 75, 82, 86, 105, 106], "distribut": [0, 8, 9, 15, 20, 25, 31, 32, 42, 62, 72, 91, 108], "ddp": [0, 1, 3, 15, 32, 89, 92, 94], "fsdp": [0, 1, 3, 15, 25, 32, 93, 94, 107], "The": [0, 1, 2, 3, 5, 6, 7, 8, 9, 14, 22, 23, 25, 27, 29, 30, 32, 33, 41, 45, 46, 51, 58, 59, 60, 62, 64, 71, 73, 74, 75, 79, 81, 82, 86, 107, 108, 112, 116, 118, 119, 123], "state": [0, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 30, 31, 32, 57, 87], "dict": [0, 14, 22, 25, 34, 36, 37, 43, 44, 73, 87, 105, 116, 117, 118, 119], "type": [0, 14, 22, 25, 30, 32, 33, 37, 43, 44, 48, 57, 62, 78], "can": [0, 1, 2, 3, 4, 5, 6, 9, 22, 23, 25, 27, 28, 29, 30, 31, 32, 35, 36, 38, 39, 40, 57, 59, 72, 75, 128], "specifi": [0, 13, 20, 23, 30, 32, 60, 75, 91, 107, 123], "fsdpstrategi": [0, 1, 3, 91, 93], "s": [0, 2, 3, 5, 6, 9, 16, 25, 27, 29, 30, 37, 60, 62, 79, 119], "state_dict_typ": [0, 90], "argument": [0, 1, 3, 5, 6, 27, 29, 41, 72, 79, 107], "like": [0, 1, 3, 15, 18, 25, 38, 45, 87, 107], "so": [0, 1, 3, 31, 71, 75, 123], "fsdp_strategi": [0, 1], "set": [0, 1, 3, 5, 6, 19, 25, 27, 29, 34, 39, 42, 46, 53, 61, 62, 63, 71, 73, 74, 75, 80, 86, 92, 93, 94, 112, 114, 121], "sharded_state_dict": 0, "prepare_fsdp": [0, 1], "strategi": [0, 1, 3, 32, 40, 89, 90, 91, 92, 93, 94], "Or": 0, "you": [0, 1, 3, 18, 22, 25, 30, 31, 79], "manual": [0, 32], "thi": [0, 1, 3, 4, 6, 7, 8, 9, 13, 16, 18, 22, 23, 25, 26, 30, 33, 34, 35, 36, 37, 39, 40, 41, 42, 45, 48, 49, 55, 57, 58, 59, 60, 61, 62, 63, 71, 72, 78, 82, 86, 87, 94, 107, 112], "set_state_dict_typ": [0, 25], "statedicttyp": [0, 90], "when": [0, 1, 2, 3, 4, 7, 11, 13, 14, 15, 23, 25, 26, 28, 34, 35, 45, 49, 61, 65, 73, 74, 82, 112], "your": [0, 1, 4, 13, 22, 30], "pass": [0, 1, 3, 4, 16, 18, 22, 25, 30, 32, 37, 41, 59, 66, 72, 79, 88, 91, 107, 116], "restoreopt": [0, 25], "avoid": [0, 45, 63, 113], "optim": [0, 3, 5, 6, 12, 27, 29, 30, 31, 32, 105, 107], "learn": [0, 3, 12, 30], "rate": [0, 3, 12, 20, 30], "schedul": [0, 3, 12, 30], "your_unit": 0, "restore_opt": [0, 25], "restore_optim": 0, "fals": [0, 1, 3, 25, 37, 66, 69, 75, 80, 89, 90, 94, 107, 114], "restore_lr_schedul": 0, "sometim": 0, "mai": [0, 5, 6, 25, 27, 29, 30, 48, 72, 87, 105], "help": [0, 1, 15, 26], "keep": [0, 14, 25, 75, 81], "track": [0, 5, 6, 12, 23, 27, 29, 72, 75, 95], "how": [0, 2, 3, 6, 23, 30, 34, 36, 37, 38, 39, 40], "perform": [0, 3, 5, 6, 9, 25, 27, 29, 30, 112, 114], "done": [0, 5, 6, 27, 29, 34, 40, 113], "bestcheckpointconfig": [0, 25], "param": [0, 3, 25, 89, 92, 94, 107], "best_checkpoint_config": [0, 25], "monitored_metr": 0, "train_loss": [0, 32], "mode": [0, 5, 6, 27, 29, 61, 111], "min": [0, 61], "By": [0, 7, 9, 25, 36, 39, 45], "monitor": [0, 8, 25, 32, 61], "expect": [0, 1, 41], "trainunit": [0, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 29, 32], "have": [0, 3, 25, 30, 32, 48, 58, 71, 105], "attribut": [0, 8, 25, 33, 61, 66, 67, 68, 69, 72, 78, 89, 90, 95, 107, 112, 114, 115], "time": [0, 5, 6, 9, 10, 18, 22, 23, 24, 25, 27, 28, 29, 66, 76, 78, 87, 112, 113, 114, 115, 117, 121], "cast": 0, "valu": [0, 3, 8, 22, 25, 34, 36, 37, 38, 39, 40, 43, 44, 48, 59, 60, 62, 63, 71, 73, 79, 98, 116, 118, 119], "float": [0, 8, 25, 32, 43, 44, 60, 61, 96, 107, 116, 117, 118, 119], "append": [0, 74, 86], "path": [0, 7, 25, 30, 65, 66, 67, 69, 72], "name": [0, 4, 7, 14, 22, 25, 34, 36, 37, 38, 39, 40, 66, 71, 73, 78, 116, 118, 119, 121], "comput": [0, 3, 32, 35, 107, 116, 118, 119], "kept": [0, 25, 112], "up": [0, 9, 28, 94], "date": 0, "appropri": [0, 25, 32, 42, 65], "user": [0, 1, 3, 13, 17, 22, 25, 28, 30, 32, 35, 75, 107], "later": 0, "restore_from_best": 0, "metric_nam": 0, "If": [0, 1, 3, 8, 14, 16, 18, 23, 25, 30, 31, 42, 43, 49, 51, 55, 58, 60, 61, 62, 63, 72, 75, 79, 81, 86, 92, 97, 107, 112, 114, 116, 118, 119, 120, 121], "d": [0, 58], "valid": [0, 25], "sai": 0, "loss": [0, 3, 30, 32, 71], "after": [0, 3, 4, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 28, 30, 32, 39, 61, 71, 72, 87, 112, 114], "each": [0, 3, 7, 9, 11, 12, 15, 16, 18, 22, 25, 28, 30, 33, 39, 48, 71, 116, 118, 119], "eval": [0, 3, 4, 5, 6, 8, 9, 10, 11, 13, 15, 16, 17, 19, 20, 22, 24, 25, 27, 28, 30, 32, 97], "epoch": [0, 3, 4, 5, 6, 8, 11, 12, 16, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 32, 96, 97, 98, 123], "dure": [0, 3, 4, 5, 6, 7, 11, 13, 25, 27, 28, 29, 95], "fit": [0, 3, 4, 22, 25, 28, 30, 31, 32, 97], "save_every_n_eval_epoch": [0, 25], "flag": [0, 3, 25, 94], "instead": [0, 25, 52, 56, 58], "eval_loss": 0, "And": 0, "onli": [0, 3, 8, 10, 20, 22, 24, 25, 28, 42, 45, 57, 60, 62, 66, 67, 69, 72, 79, 82, 86, 87, 99, 100, 101, 102, 103, 104, 105, 107], "top": [0, 25, 31, 32], "three": [0, 30, 32, 34], "keep_last_n_checkpoint": [0, 25], "3": [0, 28, 34, 36, 39, 40, 60, 64, 125], "core": [1, 3, 30], "tnt": [1, 2, 31, 32], "framework": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 33, 128], "make": [1, 9, 13, 18, 31, 60, 71], "assumpt": 1, "about": [1, 3, 28, 30, 45], "devic": [1, 3, 18, 31, 32, 35, 54, 58, 62, 82, 86, 89, 92, 93, 94, 107], "handl": [1, 3, 32, 65], "configur": [1, 3, 9, 25, 72], "own": [1, 4], "As": [1, 9, 22, 45], "conveni": [1, 3, 9, 30, 62, 95], "autounit": [1, 31, 32], "who": [1, 3, 32], "prefer": [1, 32], "automat": [1, 3, 9, 32, 55, 107], "provid": [1, 7, 23, 25, 33, 36, 37, 38, 39, 60, 72, 86], "checkpoint": [1, 3, 4, 25, 30, 31, 32, 87, 94, 95, 106], "model": [1, 2, 3, 4, 9, 13, 25, 30, 62, 64, 75, 77, 107], "ar": [1, 3, 4, 15, 18, 22, 23, 25, 30, 31, 32, 34, 36, 37, 38, 39, 40, 48, 60, 66, 72, 74, 75, 79, 81, 82, 86, 87, 107, 111, 116, 118, 119, 128], "evalunit": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 32], "predictunit": [1, 3, 4, 7, 9, 10, 11, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 27, 32], "interfac": [1, 3, 7, 30, 32, 106], "initi": [1, 3, 13, 20, 25, 47, 49, 50, 51, 52, 55, 56, 60, 62, 64, 72, 73, 74, 87, 108], "cuda": [1, 5, 6, 19, 27, 29, 32, 35, 41, 42, 45, 58, 82, 84, 86, 92, 93, 112, 114, 121], "applic": [1, 9, 25, 62], "along": [1, 116, 118, 119], "global": [1, 23, 49, 50, 51, 55, 57, 62, 63, 118, 119], "process": [1, 7, 9, 18, 22, 23, 25, 44, 47, 48, 49, 50, 54, 55, 59, 60, 62, 72, 108, 113, 118, 119], "group": [1, 12, 18, 23, 25, 48, 49, 50, 54, 59, 60, 62, 72, 118, 119], "from": [1, 3, 4, 5, 6, 11, 14, 18, 25, 27, 29, 30, 31, 32, 34, 36, 38, 39, 43, 45, 48, 54, 57, 62, 64, 68, 71, 72, 76, 87, 99, 100, 101, 102, 103, 104, 108, 113, 116, 118, 123], "torch": [1, 3, 5, 6, 10, 17, 21, 22, 24, 25, 27, 29, 30, 32, 34, 35, 36, 39, 40, 41, 42, 43, 45, 46, 49, 52, 56, 58, 60, 62, 63, 64, 88, 92, 93, 94, 107, 108, 112, 114], "we": [1, 4, 9, 10, 22, 24, 32, 35, 45, 79, 105, 111], "function": [1, 3, 4, 11, 14, 30, 37, 38, 41, 42, 48, 49, 51, 54, 55, 57, 58, 59, 60, 62, 63, 79, 82, 87, 103, 108, 117], "init_from_env": 1, "work": [1, 3, 48, 87], "torchelast": 1, "should": [1, 3, 4, 6, 7, 23, 25, 30, 33, 35, 41, 57, 58, 60, 61, 72, 112, 116, 118, 119], "invok": [1, 32, 49], "begin": [1, 26, 62], "script": [1, 13, 62], "simpli": 1, "wrap": [1, 49, 57, 92, 93, 107], "around": [1, 3, 31, 32, 47], "move": [1, 10, 32, 35, 36, 92, 93, 94], "device_id": 1, "index": [1, 38, 42], "distributeddataparallel": [1, 89, 92], "also": [1, 3, 18, 25, 31, 32, 37, 38, 42], "prepare_ddp": 1, "assist": 1, "either": [1, 3, 10, 12, 19, 21, 23, 24, 26, 30], "string": [1, 3, 7, 23, 80, 88, 91, 94], "my_auto_unit": 1, "myautounit": [1, 3], "dataclass": [1, 3, 34, 36, 37, 38, 39, 40, 89, 90, 91], "ddpstrategi": [1, 91, 92], "want": [1, 3, 14, 25, 30, 32], "custom": [1, 3, 25, 30, 33, 36, 107], "ddp_strategi": 1, "broadcast_buff": [1, 89], "check_reduct": [1, 89], "true": [1, 3, 25, 60, 61, 66, 67, 69, 75, 80, 83, 84, 85, 89, 90, 92, 93, 94, 107, 112, 114, 121], "one": [1, 3, 7, 8, 22, 23, 30, 36, 40, 50, 58, 61, 62, 72, 94, 105], "more": [1, 2, 3, 22, 25, 32, 35, 37, 38, 46, 49, 51, 55, 58, 62, 63, 72, 79, 82, 86, 107], "fullyshardeddataparallel": [1, 90, 93], "forward_prefetch": [1, 90], "limit_all_gath": [1, 90, 93], "show": 2, "basic": [2, 4, 30, 32], "It": [2, 13, 18, 20, 23, 31, 32, 37, 57, 59, 75, 78], "found": [2, 43], "here": [2, 30, 32, 51, 55, 62], "http": [2, 3, 13, 21, 25, 31, 35, 38, 45, 46, 51, 53, 55, 62, 63, 64, 94, 107], "github": [2, 13, 31, 107], "com": [2, 31, 107], "pytorch": [2, 3, 5, 6, 17, 21, 25, 27, 29, 31, 32, 35, 38, 45, 46, 51, 53, 55, 62, 63, 64, 79, 82, 87, 94, 107, 126], "blob": [2, 107], "master": [2, 31], "train_unit_exampl": 2, "py": [2, 107], "less": [2, 75, 81], "code": [2, 3, 4, 9, 17, 30], "featur": 2, "enabl": [2, 3, 25, 57, 63, 94, 112, 114], "out": [2, 4, 82, 107], "box": [2, 4], "auto_unit_exampl": 2, "datapip": 2, "dataloader2": [2, 5, 6, 27, 29], "torchdata_train_exampl": 2, "convnet": 2, "dataset": [2, 3, 26, 30, 33, 34, 36, 39, 40], "main": [2, 25, 31, 32, 41, 107], "class": [3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 30, 32, 33, 34, 35, 36, 37, 38, 39, 40, 47, 61, 64, 66, 67, 68, 69, 70, 71, 72, 73, 75, 78, 89, 90, 95, 105, 106, 107, 112, 113, 114, 115], "auto_unit": 3, "arg": [3, 11, 14, 32, 41, 59, 70, 72, 99, 100, 101, 102, 103, 104, 106, 115], "kwarg": [3, 14, 25, 41, 59, 65, 70, 72, 79, 99, 100, 101, 102, 103, 104, 106, 112, 115], "sourc": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127], "stochast": 3, "gradient": [3, 9, 32], "descent": 3, "would": [3, 15], "data": [3, 4, 5, 6, 11, 22, 26, 27, 29, 30, 31, 32, 41, 45, 68, 71, 94, 123], "parallel": [3, 94], "replic": [3, 25], "them": [3, 23, 32, 35, 71], "subclass": [3, 4, 6, 22, 24, 30, 32, 33, 37], "implement": [3, 5, 6, 7, 27, 29, 30, 32, 33, 64, 112, 114], "train_step": [3, 6, 18, 29, 30, 32], "eval_step": [3, 5, 6, 30], "predict_step": [3, 27, 30, 32], "method": [3, 25, 30, 32, 33, 34, 35, 36, 37, 38, 39, 40, 47, 51, 55, 59, 61, 62, 64, 66, 67, 68, 69, 70, 71, 72, 73, 75, 78, 89, 90, 95, 105, 106, 107, 112, 113, 114, 115], "For": [3, 22, 23, 25, 37, 38, 46, 49, 51, 55, 62, 63, 82, 86], "run": [3, 5, 6, 9, 11, 18, 27, 28, 29, 30, 31, 53, 79, 82, 86, 97, 107, 109, 110, 111, 125, 126, 127], "forward": [3, 64, 78, 79], "backward": [3, 30, 32, 64, 78, 94], "step": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 32, 66, 67, 69, 71, 75, 87, 96, 97, 98, 107, 113, 123, 124], "To": [3, 4, 30, 31, 79], "benefit": 3, "must": [3, 7, 8, 9, 23, 25, 32, 61, 62, 72, 79, 94, 107], "compute_loss": [3, 32], "configure_optimizers_and_lr_schedul": [3, 32], "addition": [3, 63], "option": [3, 4, 5, 6, 11, 14, 18, 20, 23, 25, 27, 28, 29, 30, 32, 37, 41, 47, 48, 51, 55, 57, 58, 60, 61, 62, 63, 66, 69, 72, 75, 76, 79, 82, 86, 88, 89, 90, 92, 93, 94, 96, 97, 98, 99, 100, 101, 102, 104, 107, 111, 114, 118, 119, 121, 123], "hook": [3, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 30, 32, 89], "on_train_step_end": [3, 4, 6, 8, 9, 10, 11, 13, 16, 17, 18, 20, 22, 23, 24, 29, 32], "on_eval_step_end": [3, 4, 5, 8, 9, 10, 11, 13, 15, 16, 17, 20, 22, 24], "on_predict_step_end": [3, 4, 7, 9, 10, 11, 13, 15, 16, 17, 20, 22, 24, 27], "overrid": [3, 30], "lr": [3, 32], "step_lr_schedul": 3, "case": [3, 30, 32, 48, 60], "thei": [3, 25, 71, 72, 92], "logic": [3, 4, 18, 30, 37, 38], "Then": [3, 30], "evalu": [3, 4, 6, 9, 10, 11, 14, 15, 16, 17, 20, 22, 25, 28, 30, 31, 32, 72], "predict": [3, 4, 7, 9, 10, 11, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 28, 30, 31, 32], "entri": [3, 4, 25, 28, 32, 82], "point": [3, 4, 9, 28, 30, 32, 49, 71], "normal": [3, 107], "advanc": 3, "directli": 3, "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 32, 34, 35, 36, 38, 39, 40, 41, 43, 45, 46, 48, 51, 55, 57, 58, 59, 60, 61, 62, 63, 64, 66, 67, 69, 71, 72, 74, 75, 78, 79, 80, 81, 82, 86, 87, 88, 91, 92, 93, 94, 107, 108, 112, 114, 116, 118, 119, 120, 121, 123], "step_lr_interv": 3, "whether": [3, 8, 19, 23, 25, 28, 45, 61, 66, 78, 107, 112, 114, 121], "lr_schedul": [3, 5, 6, 27, 29, 30, 32], "everi": [3, 9, 18, 19, 23, 25, 26, 32], "default": [3, 7, 9, 10, 14, 18, 19, 20, 22, 24, 25, 30, 33, 36, 37, 39, 45, 48, 51, 53, 54, 55, 58, 59, 60, 62, 63, 66, 71, 73, 75, 82, 86, 91, 107, 112, 114, 118, 119, 121, 123], "precis": [3, 31, 32, 46, 62, 71], "mix": [3, 32], "dtype": [3, 88], "accept": [3, 11, 105], "fp32": 3, "fp16": 3, "bf16": 3, "gradient_accumulation_step": [3, 32], "mani": 3, "batch": [3, 4, 11, 22, 24, 30, 32, 34, 35, 36, 38, 39, 40, 75, 77, 89, 107], "accumul": [3, 32], "over": [3, 30, 32, 34, 36, 37, 38, 39, 40], "detect_anomali": 3, "anomali": [3, 32, 72], "detect": [3, 18, 32, 72], "autograd": 3, "engin": 3, "org": [3, 21, 25, 35, 38, 45, 46, 51, 53, 55, 62, 63, 64, 94], "doc": [3, 21, 35, 45, 46, 51, 53, 55, 62, 63, 94], "stabl": [3, 21, 35, 45, 46, 51, 53, 55, 62, 63, 94], "html": [3, 13, 21, 25, 35, 38, 45, 46, 51, 53, 55, 62, 63, 94], "clip_grad_norm": 3, "max": [3, 5, 6, 27, 29, 61, 123], "norm": [3, 77, 89], "clip": [3, 32], "gener": [3, 4, 9, 14, 25, 37, 38, 45, 46, 63, 71, 74, 79, 80, 94, 117, 120, 121], "util": [3, 5, 6, 10, 14, 21, 22, 24, 25, 27, 29], "clip_grad_norm_": 3, "clip_grad_valu": 3, "clip_grad_value_": 3, "swa_param": 3, "weight": [3, 39, 107], "averag": [3, 10, 107], "pleas": [3, 37, 38, 49], "see": [3, 25, 32, 46, 51, 55, 62, 63, 72, 82, 86, 107], "note": [3, 13, 25, 58, 63, 72], "torch_compile_param": [3, 94], "compil": [3, 32, 94], "activation_checkpoint_param": [3, 94], "activ": [3, 14, 28, 79, 94, 107], "creat": [3, 4, 9, 30, 32, 45, 58, 72], "enable_compiled_autograd": [3, 94], "compiled_autograd": [3, 94], "an": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 20, 22, 23, 24, 25, 27, 28, 29, 30, 32, 33, 35, 37, 55, 60, 61, 71, 81, 82, 85, 88, 91, 92, 93, 94, 108, 115, 123], "experiment": [3, 94], "loss_backward_retain_graph": 3, "none": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 45, 46, 47, 48, 49, 50, 51, 55, 57, 58, 60, 61, 62, 63, 64, 66, 67, 68, 69, 71, 72, 73, 74, 75, 77, 78, 79, 81, 82, 86, 87, 89, 90, 92, 93, 94, 95, 97, 98, 99, 100, 101, 102, 103, 104, 105, 107, 112, 113, 114, 118, 119, 121, 122, 123, 124], "graph": 3, "grad": [3, 87], "freed": [3, 45], "nearli": 3, "all": [3, 7, 9, 13, 14, 15, 25, 32, 34, 36, 38, 39, 48, 49, 58, 60, 66, 67, 69, 72, 120], "need": [3, 9, 25, 30, 32, 45, 57, 107, 128], "often": [3, 6, 23], "much": 3, "effici": 3, "wai": [3, 32], "enable_prefetch": 3, "prefetch": [3, 35], "befor": [3, 4, 7, 9, 12, 13, 14, 16, 17, 18, 19, 20, 22, 23, 26, 30, 59, 64, 66, 67, 69, 75, 112, 114], "next": [3, 4, 11, 30, 36], "zero_grad_at_train_step_start": 3, "zero": [3, 31, 75, 87], "start": [3, 4, 7, 9, 10, 11, 12, 14, 16, 17, 19, 20, 22, 23, 24, 25, 26, 28, 30, 32, 75, 107], "rather": 3, "than": [3, 61, 75, 81, 112], "end": [3, 4, 7, 8, 9, 10, 11, 13, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 28, 30, 32], "inspect": 3, "log": [3, 10, 12, 14, 16, 18, 19, 21, 22, 24, 25, 26, 31, 32, 66, 67, 68, 69, 71, 72, 99, 100, 101, 102, 104, 112, 114, 121], "certain": [3, 16, 45, 87], "through": [3, 37], "well": [3, 57, 75], "swaparam": 3, "swa": [3, 31], "shard": 3, "same": [3, 7, 9, 25, 30, 36, 37, 38, 48, 71, 77, 112], "avail": [3, 25, 42, 52, 56, 60, 62, 82, 86, 87, 112, 114, 121], "0": [3, 8, 10, 20, 22, 24, 25, 32, 34, 36, 39, 40, 52, 53, 55, 57, 60, 61, 63, 66, 67, 69, 71, 72, 89, 95, 99, 100, 101, 102, 103, 104, 107, 113, 116, 118, 119, 125, 126], "higher": 3, "origin": [3, 58], "output": [3, 7, 20, 28, 30, 32, 71, 78, 79, 82, 86, 123], "call": [3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 32, 41, 45, 51, 55, 57, 59, 72, 87, 103, 112, 114], "self": [3, 4, 30, 32], "swa_model": 3, "input": [3, 30, 32, 36, 58, 60, 63, 78, 116, 118, 119, 120], "ensur": [3, 15, 87, 107, 112, 114], "especi": [3, 9, 26], "fire": 3, "correctli": 3, "abstract": [3, 30, 31, 32, 33, 67, 70], "tdata": [3, 28], "tupl": [3, 14, 30, 32, 79], "tensor": [3, 8, 18, 30, 32, 34, 36, 39, 40, 45, 48, 79, 87, 89], "ani": [3, 5, 6, 14, 25, 27, 29, 30, 32, 41, 59, 60, 63, 65, 72, 79, 99, 100, 101, 102, 103, 104, 112], "object": [3, 5, 6, 9, 23, 27, 28, 29, 30, 34, 36, 37, 38, 39, 40, 58, 64, 72, 79, 81, 89, 96, 97, 98, 105, 119, 120, 123], "return": [3, 28, 30, 32, 34, 36, 39, 40, 41, 43, 44, 48, 52, 56, 57, 58, 59, 60, 62, 65, 83, 84, 85, 97, 98, 108, 116, 118, 119], "contain": [3, 25, 28, 30, 31, 32, 33, 34, 35, 37, 58, 78, 79, 88], "part": [3, 32], "lrschedul": [3, 105], "construct": [3, 35, 45, 72, 123], "upon": [3, 25], "A": [3, 4, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 26, 28, 34, 36, 37, 38, 39, 40, 43, 47, 55, 59, 64, 73, 74, 79, 87, 98, 112, 114, 116, 118, 119], "requir": [3, 30, 63, 64], "iter": [3, 4, 5, 6, 10, 22, 25, 26, 27, 28, 29, 30, 34, 35, 36, 37, 38, 39, 40, 90, 96, 97, 98, 123], "wish": [3, 30], "decor": [3, 30, 57], "inference_mod": [3, 30], "improv": [3, 8, 9, 30, 61], "metadata": [3, 30], "get_next_eval_batch": [3, 5, 30], "data_it": [3, 30], "union": [3, 4, 7, 10, 11, 12, 19, 20, 21, 23, 24, 25, 26, 30, 34, 36, 37, 38, 39, 40, 58, 60, 63, 89, 90, 91, 94, 105, 123], "otherwis": [3, 9, 30, 45, 52, 56, 107], "get": [3, 4, 20, 30, 38, 42, 43, 44, 51, 52, 53, 54, 55, 56, 125, 126], "get_next_predict_batch": [3, 27, 30], "get_next_train_batch": [3, 6, 29, 30], "int": [3, 5, 6, 8, 9, 10, 14, 15, 18, 20, 22, 23, 24, 25, 27, 28, 29, 32, 33, 35, 51, 52, 53, 55, 56, 59, 60, 61, 63, 66, 67, 69, 71, 74, 76, 81, 82, 89, 90, 95, 96, 97, 98, 108, 112, 122, 123, 124], "updat": [3, 9, 20, 25, 31, 32, 107, 122, 124], "metric": [3, 8, 25, 31, 32, 61, 70, 71, 72], "do": [3, 8, 22, 31, 32, 71], "anyth": 3, "els": [3, 57, 66, 67, 69], "been": [3, 23, 34, 40, 62], "complet": [3, 10, 22, 24, 25, 28, 123, 124], "on_train_epoch_end": [3, 4, 6, 8, 11, 16, 18, 20, 21, 22, 23, 26, 29, 30, 32], "rememb": 3, "super": [3, 30, 32], "result": [3, 9, 32, 48, 60, 73, 113, 117], "trainstepresult": [3, 32], "total": [3, 25, 33, 97, 98], "extract": [3, 59], "zero_grad": [3, 30, 32], "exampl": [3, 4, 5, 6, 11, 15, 22, 23, 25, 27, 29, 30, 34, 35, 36, 37, 38, 39, 40, 57, 58, 59, 60, 64, 68, 71, 72, 75, 92, 93, 108, 125, 126], "customautounit": 3, "def": [3, 4, 11, 30, 32, 57], "autopredictunit": 3, "str": [3, 4, 7, 8, 12, 14, 22, 23, 25, 30, 32, 34, 36, 37, 38, 39, 40, 43, 44, 46, 51, 54, 55, 58, 59, 60, 62, 63, 65, 66, 67, 69, 72, 75, 79, 80, 82, 86, 88, 90, 91, 94, 105, 116, 117, 118, 119, 120, 121, 123], "torchcompileparam": [3, 94], "bool": [3, 25, 28, 37, 60, 61, 66, 67, 69, 80, 83, 84, 85, 89, 90, 94, 107, 109, 110, 114, 121, 127], "tpredictdata": [3, 4, 7, 9, 10, 11, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 27, 30], "extens": [4, 32], "supplement": [4, 25], "loop": [4, 5, 6, 9, 11, 16, 23, 27, 28, 29, 30, 31, 32, 95, 98, 123], "addit": [4, 25, 30, 32, 45, 112], "good": [4, 71], "candid": 4, "ones": [4, 25], "re": [4, 64, 87], "across": [4, 7, 9, 16, 25, 26, 49, 60, 63, 118, 119], "intend": [4, 32, 33, 62], "go": 4, "write": [4, 7, 26, 45, 66, 67, 69, 72, 86], "add": [4, 49], "below": [4, 5, 6, 27, 29, 30], "print": [4, 11, 14, 19, 32, 34, 36, 39, 40, 60, 71, 80, 103], "messag": [4, 20, 85, 99, 100, 101, 102, 104, 123], "variou": [4, 31, 32], "execut": [4, 5, 6, 9, 27, 28, 29, 57, 61, 62], "import": [4, 5, 6, 9, 11, 27, 29, 30, 32, 57, 64, 68, 71, 72, 108], "tevalunit": [4, 32], "tpredictunit": [4, 32], "ttrainunit": [4, 32], "printingcallback": [4, 32], "on_train_start": [4, 6, 9, 11, 14, 16, 17, 23, 25, 26, 29, 30, 32], "on_train_end": [4, 6, 9, 10, 11, 16, 17, 22, 29, 30, 32], "on_eval_start": [4, 5, 9, 11, 14, 16, 17, 22, 30, 32], "on_eval_end": [4, 5, 9, 10, 11, 16, 17, 22, 30, 32], "on_predict_start": [4, 7, 9, 11, 14, 16, 17, 22, 27, 30, 32], "on_predict_end": [4, 7, 9, 10, 11, 16, 17, 22, 27, 30, 32], "instanti": [4, 13, 32, 75], "printing_callback": 4, "train_unit": [4, 29, 30], "properti": [4, 25, 28], "distinct": 4, "per": [4, 5, 6, 22, 27, 28, 29, 71, 112, 123], "instanc": [4, 5, 6, 10, 13, 16, 21, 22, 24, 25, 27, 28, 29, 37, 75, 91, 92, 93, 108], "debug": [4, 16, 18, 28, 32, 100], "profil": [4, 17, 73, 75], "purpos": 4, "on_eval_dataloader_iter_creation_end": [4, 11], "tevaldata": [4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 19, 20, 22, 24, 25, 30], "on_eval_dataloader_iter_creation_start": [4, 11], "on_eval_epoch_end": [4, 5, 8, 11, 16, 20, 30], "on_eval_epoch_start": [4, 5, 11, 16, 19, 20, 30], "new": [4, 12, 16, 19, 20, 22, 30, 51, 58, 72], "on_eval_get_next_batch_end": [4, 11], "on_eval_get_next_batch_start": [4, 11], "on_eval_step_start": [4, 5, 11, 16, 19], "on_except": [4, 7, 11, 25], "ttraindata": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 29, 30], "exc": [4, 7, 25], "baseexcept": [4, 7, 11, 25, 83, 84, 85], "except": [4, 5, 6, 7, 11, 25, 27, 29, 37, 83, 84, 85], "occur": [4, 7, 11, 25, 26, 82, 107], "on_predict_dataloader_iter_creation_end": [4, 11], "on_predict_dataloader_iter_creation_start": [4, 11], "on_predict_epoch_end": [4, 11, 16, 20, 27, 30], "on_predict_epoch_start": [4, 11, 16, 19, 20, 27, 30], "on_predict_get_next_batch_end": [4, 11], "on_predict_get_next_batch_start": [4, 11], "on_predict_step_start": [4, 11, 16, 19, 27], "on_train_dataloader_iter_creation_end": [4, 11], "on_train_dataloader_iter_creation_start": [4, 11], "on_train_epoch_start": [4, 6, 11, 12, 16, 19, 20, 22, 29, 30], "on_train_get_next_batch_end": [4, 11], "on_train_get_next_batch_start": [4, 11], "on_train_step_start": [4, 6, 11, 12, 16, 19, 29], "sever": [4, 30, 32, 48], "pre": 4, "written": [4, 7, 72], "readi": 4, "eval_unit": [5, 30], "eval_dataload": [5, 6, 97], "max_steps_per_epoch": [5, 27, 28, 29, 96, 98, 123], "list": [5, 6, 7, 12, 14, 16, 19, 22, 25, 26, 27, 29, 48, 59, 72, 73, 74, 116, 118], "timer": [5, 6, 22, 27, 28, 29, 31], "timerprotocol": [5, 6, 27, 28, 29, 112, 114, 119, 120], "take": [5, 6, 9, 25, 27, 29], "modifi": [5, 6, 27, 28, 29, 30], "includ": [5, 6, 19, 27, 29, 31, 32, 38, 62, 89, 95], "etc": [5, 6, 14, 18, 25, 27, 29, 32, 37, 38, 59], "number": [5, 6, 9, 10, 20, 22, 24, 25, 27, 28, 29, 33, 35, 48, 51, 55, 59, 61, 63, 66, 67, 69, 71, 78, 82, 96, 97, 98, 107, 108, 112, 123, 124], "mean": [5, 6, 27, 29, 64, 78, 116, 118, 119], "until": [5, 6, 27, 29, 34], "exhaust": [5, 6, 27, 29, 34, 36, 39, 40], "kei": [5, 6, 25, 27, 28, 29, 34, 36, 37, 38, 39, 40, 43, 44, 59, 73], "event": [5, 6, 27, 28, 29, 72, 75, 121], "synchron": [5, 6, 9, 27, 29, 49, 51, 57, 60, 72, 112, 114, 118, 119, 121], "degrad": [5, 6, 27, 29], "myevalunit": [5, 30], "20": [5, 23, 27, 58], "pseudocod": [5, 6, 27, 29], "what": [5, 6, 25, 27, 29, 107], "doe": [5, 6, 8, 9, 27, 29, 87], "first": [5, 6, 16, 23, 27, 29, 31, 87], "while": [5, 6, 27, 29, 34, 40], "try": [5, 6, 27, 29], "increment": [5, 6, 27, 29], "counter": [5, 6, 27, 29, 64], "stopiter": [5, 6, 27, 29], "break": [5, 6, 27, 29], "max_epoch": [6, 28, 29, 32], "max_step": [6, 28, 29, 96, 97, 98, 123], "max_train_steps_per_epoch": [6, 97], "max_eval_steps_per_epoch": [6, 97], "evaluate_every_n_step": [6, 28], "evaluate_every_n_epoch": [6, 28], "interleav": [6, 30, 32, 35], "both": [6, 15, 23, 107], "limit": [6, 23, 29], "infinit": [6, 29, 61], "unless": [6, 29], "stop": [6, 8, 23, 28, 29, 31, 34, 39, 40, 61], "term": [6, 26, 28], "fit_unit": 6, "myfitunit": 6, "4": [6, 29, 34, 36, 39, 40, 60, 71], "header_row": 7, "dir_path": 7, "delimit": 7, "t": [7, 32, 41, 45, 63, 64, 97, 98], "filenam": [7, 51, 86], "csv": [7, 66], "file": [7, 13, 20, 51, 62, 66, 67, 69, 72, 75, 123], "simplifi": [7, 31, 32], "extend": [7, 30], "get_step_output_row": 7, "desir": [7, 57], "row": 7, "match": 7, "column": 7, "defin": [7, 23, 28, 30, 32, 37, 38, 40, 72, 92, 93, 106, 112, 115], "directori": [7, 13, 25, 75, 82, 86], "where": [7, 13, 20, 25, 30, 45, 48, 59, 75, 123], "separ": 7, "tab": 7, "monitored_attr": 8, "early_stop_check": 8, "earlystopcheck": 8, "interv": [8, 23, 32, 73, 74, 113], "liter": [8, 19, 23, 60, 61, 62, 107], "phase": [8, 28, 30], "interval_freq": [8, 23], "check": [8, 18, 23, 61, 107], "earli": [8, 13, 31, 61], "rank": [8, 16, 18, 20, 22, 23, 25, 31, 51, 52, 53, 55, 57, 59, 60, 66, 67, 69, 71, 72, 99, 100, 101, 102, 103, 104, 108, 113, 118, 119], "step_interv": 9, "period": [9, 25, 73, 74], "garbag": 9, "collect": [9, 13, 22, 25, 47, 59, 72, 78], "In": [9, 30, 48, 60, 61], "fulli": 9, "program": [9, 42, 45, 62, 127], "multipl": [9, 45, 46, 62, 105], "These": [9, 30, 32, 128], "commun": [9, 23, 25, 55, 59, 89], "other": [9, 15, 18, 25, 60, 113], "overal": 9, "therefor": 9, "gate": 9, "slowest": [9, 18], "roughli": 9, "amount": [9, 10, 22, 23, 24], "its": [9, 45, 78, 79], "straggler": 9, "python": [9, 63, 109, 110, 125], "trigger": [9, 18], "differ": [9, 18, 25, 30, 31, 32, 48, 71], "possibl": [9, 13, 23], "lead": 9, "frequenc": [9, 10, 15, 18, 22, 24, 25, 28, 32], "tune": 9, "base": [9, 25, 33, 42, 62, 64, 85, 107], "hand": 9, "free": [9, 45, 55, 59, 75], "some": [9, 30, 87], "reap": 9, "minim": 9, "overhead": 9, "compar": [9, 18], "full": 9, "cleanup": 9, "logger": [10, 12, 18, 19, 21, 22, 24, 26, 31, 32, 99, 100, 101, 102, 104], "metriclogg": [10, 12, 18, 19, 22, 24, 26], "summarywrit": [10, 21, 24, 72], "moving_avg_window": 10, "log_every_n_step": [10, 22, 24, 32], "warmup_step": [10, 22, 24], "scalar": [10, 24], "tensorboard": [10, 21, 24, 32, 72], "tensorboardlogg": [10, 21, 32], "control": [10, 13, 22, 24, 25, 30, 32, 63], "window": [10, 127], "warmup": [10, 22, 24], "were": [10, 22, 24, 71], "callabl": [11, 14, 57, 59, 89, 90, 111], "retriev": 11, "mydataload": 11, "print_on_step_start": 11, "f": [11, 60], "eval_progress": 11, "num_steps_complet": [11, 32, 95, 96, 122, 123, 124], "lambda_cb": 11, "logging_interv": [12, 19], "associ": 12, "memory_snapshot_profil": 13, "memorysnapshotprofilerbas": 13, "memori": [13, 19, 31, 35, 45, 68, 75, 82, 86, 87], "snapshot": [13, 25, 75, 82, 86], "pickl": 13, "zdevito": 13, "io": 13, "2022": 13, "08": 13, "16": [13, 22], "recommend": [13, 16, 18, 22, 32, 35], "ideal": [13, 64, 75], "sure": [13, 18, 31], "alloc": [13, 45, 75, 87], "captur": [13, 73], "max_depth": [14, 81], "process_fn": 14, "module_summari": 14, "_log_module_summary_t": 14, "module_input": [14, 64], "mutablemap": [14, 79], "summari": [14, 31, 78, 81, 120], "maximum": [14, 23, 28, 81, 82], "depth": [14, 81], "tabl": 14, "map": [14, 22, 34, 36, 38, 39, 40, 43, 44, 116, 118, 119], "flop": [14, 31, 78, 79], "size": [14, 19, 22, 33, 48, 56, 73, 74, 78, 79], "rais": [14, 23, 37, 42, 43, 61, 63, 75, 81, 88, 91, 112, 114, 116, 118, 119, 120, 121], "runtimeerror": [14, 42], "torchev": 14, "instal": 14, "sync_every_n_step": 15, "1000": [15, 32], "sync": [15, 48, 89, 116, 118, 119], "worker": [15, 51, 55], "given": [15, 38, 61, 65, 113, 120, 121], "without": [15, 28, 61], "still": [15, 45], "larg": 15, "job": [15, 23], "simpl": [16, 30, 68, 72], "progress": [16, 20, 25, 26, 31, 32, 105, 122, 123, 124], "issu": [16, 31, 47], "root": [16, 81], "caus": [16, 18], "might": [16, 45, 105], "unequ": 16, "nccl": [16, 18, 59], "timeout": [16, 18, 59, 62], "item": [16, 22, 33, 34, 36, 39, 40], "context": [17, 42, 64, 74], "manag": [17, 25, 64, 74], "check_every_n_step": 18, "check_every_n_epoch": 18, "pg": [18, 47, 60, 118, 119], "processgroup": [18, 25, 47, 48, 60, 89, 90, 113, 118, 119], "slow": 18, "n": [18, 25, 60], "lag": 18, "behind": 18, "between": [18, 22, 23, 61, 77], "fastest": 18, "report": [18, 22], "all_gather_tensor": 18, "store": [18, 67, 69, 73, 105, 112, 114, 115], "infer": [18, 32, 123], "environ": [18, 20, 31, 42, 51, 53, 55, 62, 72, 126], "system": [19, 51, 127], "stat": [19, 32, 43, 44], "cpu": [19, 28, 42, 44, 58, 83], "usag": 19, "resid": [19, 73, 74], "gpu": [19, 42, 43, 112, 114], "refresh_r": [20, 122, 124], "textio": [20, 123], "stringio": [20, 123], "bar": [20, 122, 123, 124], "visual": [20, 22, 26, 75], "determin": [20, 23, 46, 61, 63, 109, 110], "sy": [20, 123], "stderr": [20, 123], "histogram": [21, 116, 118], "writer": 21, "throughput_per_batch": 22, "throughput": 22, "qp": 22, "second": [22, 59, 62, 76], "basi": 22, "measur": [22, 64, 73, 74, 113, 121], "divid": 22, "took": 22, "On": [22, 72], "granular": [22, 49], "leverag": [22, 35], "alreadi": [22, 35, 50, 62, 107], "wait": [22, 24], "calcul": [22, 78, 79, 97], "correspond": [22, 48], "instac": 22, "queri": 22, "32": 22, "two": [22, 23, 31, 32, 40, 77], "chart": 22, "8": [22, 34, 36, 39, 40, 108, 125], "label": 22, "could": 22, "accur": [22, 112, 114, 121], "place": [22, 30, 32, 87], "durat": [23, 116, 117, 118, 119], "timedelta": [23, 62, 73, 74, 113], "timestamp": 23, "datetim": [23, 62, 73, 74], "spent": 23, "reach": [23, 112], "absolut": [23, 61], "At": 23, "least": [23, 60], "condit": [23, 52, 56], "met": [23, 52, 56], "spend": 23, "form": 23, "dd": 23, "hh": 23, "mm": 23, "dai": [23, 76], "hour": 23, "minut": [23, 62], "00": 23, "indic": [23, 25, 34, 36, 37, 38, 39, 40, 98], "even": [23, 25], "ha": [23, 31, 32, 34, 37, 38, 40, 61, 62, 92, 120], "yet": 23, "timezon": 23, "awar": 23, "exceed": 23, "valueerror": [23, 61, 63, 75, 81, 88, 91, 112, 114, 116, 118, 119, 120, 121], "i": [23, 48, 59], "e": [23, 30, 32, 80], "process_group": [25, 89, 90], "async_checkpoint": 25, "storage_opt": 25, "knob_opt": 25, "knobopt": 25, "torchsnapshot": 25, "appstatemixin": 25, "random": [25, 33, 63], "epoch_": 25, "_step_": 25, "parent": [25, 28], "intra": 25, "most": [25, 121], "recent": 25, "excess": 25, "present": 25, "oldest": [25, 112], "delet": 25, "clean": 25, "best": 25, "config": [25, 108], "read": [25, 28, 37, 38], "off": 25, "prior": [25, 92], "entir": 25, "world": [25, 47, 48, 56], "asynchron": [25, 66, 113], "glob": 25, "pattern": 25, "inform": [25, 28, 46, 51, 55, 58, 62, 78, 80, 82, 86], "api_refer": 25, "safer": 25, "realli": 25, "thing": 25, "grad_scal": 25, "mark": 25, "unsur": 25, "leav": 25, "field": 25, "unset": 25, "keyword": [25, 41, 72], "storag": [25, 30], "plugin": 25, "document": [25, 37, 38], "knob": 25, "constructor": 25, "oper": [25, 35, 46, 62, 63, 72, 127], "broadcast": [25, 48, 60], "state_dict": [25, 87, 95, 105], "castabl": 25, "maintain": [25, 31, 32], "accuraci": [25, 32, 68, 71, 72], "respons": 25, "reset": [25, 32, 64, 113, 115], "collis": 25, "app": [25, 47], "static": 25, "restor": [25, 87], "strict": 25, "skip": [25, 34, 37, 40, 107, 111], "filter": 25, "allow": [25, 30, 47, 107], "app_stat": 25, "vs": [26, 80], "predict_unit": [27, 30], "predict_dataload": 27, "mypredictunit": [27, 30], "entry_point": 28, "entrypoint": [28, 108], "train_stat": 28, "tstepoutput": 28, "eval_st": 28, "predict_st": 28, "active_phas": 28, "activephas": 28, "current": [28, 42, 60, 62, 79, 96, 98, 125, 126, 127], "One": 28, "active_phase_st": 28, "meta": [28, 92], "should_stop": 28, "termin": 28, "signal": [28, 61], "record": [28, 41, 45, 75, 82, 116, 117, 118, 119, 120], "latenc": 28, "iteration_tim": 28, "alwai": 28, "synchronis": 28, "step_output": 28, "last": 28, "mytrainunit": [29, 30], "concept": [30, 32], "repres": [30, 32, 89, 90], "primari": [30, 32], "organ": 30, "mutual": [30, 32], "exclus": [30, 32], "g": [30, 32, 80], "behavior": [30, 112], "fetch": [30, 51, 55], "typecheck": 30, "__init__": [30, 32, 33, 34, 35, 36, 37, 38, 39, 40, 47, 61, 64, 66, 67, 68, 69, 70, 71, 72, 73, 75, 78, 89, 90, 95, 105, 106, 107, 112, 113, 114, 115], "_lrschedul": 30, "target": [30, 32], "binary_cross_entropy_with_logit": [30, 32], "on_checkpoint_sav": 30, "checkpoint_id": 30, "successfulli": 30, "id": 30, "wa": [30, 45], "depend": 30, "url": 30, "uniqu": 30, "identifi": [30, 71], "plan": 30, "refer": [30, 37, 38, 49], "my_unit": [30, 32], "librari": [31, 32, 63], "tool": [31, 32], "compon": [31, 32], "level": [31, 32], "repo": [31, 32], "lightweight": [31, 32], "grab": [31, 32], "bag": [31, 32], "independ": [31, 32, 128], "relat": [31, 32, 83, 84, 128], "wrapper": [31, 32, 47, 105], "publish": [31, 32], "pip": 31, "version": [31, 107], "just": 31, "git": 31, "upgrad": 31, "checker": 31, "filesystem": [31, 65], "spec": 31, "memorysnapshotprofil": 31, "oom": [31, 75], "prepar": 31, "test": [31, 111], "tqdm": 31, "misc": 31, "welcom": 32, "descript": [32, 123], "immedi": 32, "combin": 32, "myexampleunit": 32, "_modul": 32, "_devic": 32, "_optim": 32, "_log_every_n_step": 32, "_accuraci": 32, "binaryaccuraci": 32, "_tb_logger": 32, "trainer": 32, "our": 32, "task": 32, "copy_data_to_devic": 32, "squeez": 32, "step_count": 32, "train_progress": 32, "acc": 32, "log_dict": [32, 71], "train_accuraci": 32, "train_accuracy_epoch": 32, "predictbatch": 32, "256": 32, "10": [32, 34, 36, 39, 40, 68, 72, 75], "5": [32, 34, 36, 39, 40, 60, 75], "howev": 32, "don": [32, 63], "necessarili": 32, "themselv": 32, "appli": [32, 107, 112], "tb_logger": 32, "multiclassaccuraci": 32, "gamma": 32, "tlrschedul": 32, "adadelta": 32, "steplr": 32, "step_siz": 32, "nll_loss": 32, "_": 32, "mechan": [32, 34, 39, 40], "inject": 32, "within": [32, 42, 63], "page": 32, "detail": [32, 37, 38, 63, 72], "suit": 32, "rang": [32, 34, 36, 39, 40, 42, 60, 63, 112, 116, 118, 119], "concret": 33, "_generate_random_item": 33, "produc": 33, "singl": [33, 36, 47, 59, 72, 79, 108], "titem": 33, "individual_dataload": [34, 36, 37, 38, 39, 40], "iteration_strategi": [34, 36, 37, 38, 39, 40], "alldatasetbatch": 34, "all_datasets_exhaust": [34, 39, 40], "finish": 34, "till": [34, 36, 40], "largest": [34, 40], "those": [34, 40], "smallest_dataset_exhaust": [34, 40], "onc": [34, 40, 45, 61], "smallest": [34, 40], "restart_until_all_datasets_exhaust": 34, "restart": 34, "format": [34, 36, 39, 40, 117], "dataloader_1_nam": 34, "batch_obtained_from_dataloader_1": 34, "dataloader_2_nam": 34, "batch_obtained_from_dataloader_2": 34, "loader": [34, 36, 39, 40], "batch_siz": [34, 36, 39, 40], "b": [34, 36, 39, 40], "15": [34, 36, 39, 40], "all_dataset_batch_strategi": 34, "stopping_mechan": [34, 39, 40], "stoppingmechan": [34, 39, 40], "combined_iter": [34, 36, 39, 40], "6": [34, 36, 39, 40], "7": [34, 36, 39, 40], "9": [34, 36, 39, 40], "11": [34, 36, 39, 40], "12": [34, 36, 39, 40, 126], "13": [34, 36, 39, 40, 64, 79], "14": [34, 36, 39, 40], "data_iter": 35, "num_prefetch_batch": 35, "host": [35, 82, 86], "copi": [35, 41, 64, 107], "effect": 35, "pin": 35, "data_prefetch": 35, "inord": 36, "order": [36, 38, 40, 71, 113, 121], "overridden": [36, 59], "repetit": 36, "dataloader_nam": [36, 39, 40], "batch_from_dataload": [36, 39, 40], "randomizedbatchsampl": [36, 39], "in_order_strategi": 36, "randomizedbatchsampleriter": 36, "dataiterationstrategi": [37, 38], "iterator_cl": 37, "multiiter": 37, "ignore_empty_data": 37, "cycl": [37, 38, 40], "individu": [37, 38], "dictionari": [37, 112, 114, 116, 118, 119], "torchdata": [37, 38], "multi": [37, 38, 59, 108], "achiev": [37, 38], "mux": [37, 38], "mux_longest": [37, 38], "zip": [37, 38], "accompani": 38, "particular": 38, "beta": 38, "randomli": 39, "sampl": [39, 112], "chang": [39, 61], "anoth": [39, 45], "randomized_batch_sampl": 39, "roundrobin": 40, "robinrobin": 40, "round_robin_strategi": 40, "stream_to_record": 41, "stream": [41, 45, 121], "recurs": 41, "side": 41, "posit": [41, 72], "correct": 41, "mp": 42, "reli": [42, 87], "local_rank": [42, 53], "variabl": [42, 53, 72], "made": 42, "launcher": [42, 108], "outsid": [42, 63], "gpustat": 43, "nvidia": 43, "smi": 43, "utilization_gpu_perc": 43, "utilization_memory_perc": 43, "fan_speed_perc": 43, "memory_used_mb": 43, "memory_free_mb": 43, "temperature_gpu_celsiu": 43, "temperature_memory_celsiu": 43, "filenotfounderror": 43, "command": 43, "cpustat": 44, "psutil": 44, "cpu_vm_perc": 44, "cpu_perc": 44, "cpu_swap_perc": 44, "worker_cpu_time_us": 44, "worker_cpu_time_system": 44, "worker_rss": 44, "element": 45, "being": [45, 121], "reus": 45, "mention": 45, "record_stream": 45, "cach": 45, "newli": 45, "trace": [45, 82], "tell": 45, "underli": 45, "longer": 45, "creator": 45, "notabl": 45, "trick": 45, "high": [46, 62], "float32": 46, "matrix": [46, 62], "convolut": 46, "set_float32_matmul_precis": 46, "backend": [46, 54, 59, 62], "cudnn": [46, 63], "allow_tf32": 46, "datatyp": 46, "consist": 47, "fashion": 47, "regardless": 47, "follow": [47, 62, 71, 78], "scenario": 47, "gather": 48, "onto": 48, "dimens": [48, 58], "pad": 48, "trim": 48, "secur": 48, "equal": [48, 62, 75], "workload": 48, "gathered_result": 48, "pgwrapper": 49, "destroi": 50, "world_siz": [51, 55, 56, 59], "init": [51, 55], "tcp": [51, 55, 62], "protocol": [51, 55, 115], "share": 51, "get_world_s": [51, 55], "get_global_rank": [51, 55], "temporari": 51, "env": [52, 56], "var": [52, 56], "neither": [52, 56, 75], "popul": 53, "elast": 53, "hostnam": 55, "port": [55, 59], "address": 55, "belong": [55, 71], "localhost": [55, 59], "select": 55, "fn": 57, "tparam": [57, 59], "treturn": [57, 59, 111], "judici": 57, "never": 57, "veri": 57, "carefulli": 57, "mutat": 57, "local": 57, "foo": 57, "x": 57, "wrapped_fn": 57, "helper": [58, 117], "convert": [58, 76, 88, 91], "syncbatchnorm": 58, "layer": 58, "batchnorm": 58, "revert": 58, "convert_sync_batchnorm": 58, "network": 58, "sequenti": 58, "batchnorm1d": 58, "sync_bn_modul": 58, "reverted_modul": 58, "method_arg": 59, "method_kwarg": 59, "spawn": 59, "node": [59, 108], "gloo": 59, "60": 59, "timeout_": 59, "l": 59, "methods_kwarg": 59, "val": 60, "coherence_mod": 60, "rank_zero": 60, "boolean": 60, "member": 60, "manner": 60, "receiv": 60, "truth": 60, "integ": [60, 63, 123], "ratio": 60, "synced_v": 60, "iff": 60, "success": [60, 71], "patienc": 61, "min_delta": 61, "check_finit": 61, "threshold_mod": 61, "ab": 61, "rel": 61, "stopping_threshold": 61, "divergence_threshold": 61, "decreas": 61, "increas": 61, "minimum": 61, "qualifi": 61, "improvement_threshold": 61, "best_val": 61, "threshold": 61, "becom": 61, "nan": 61, "delta": [61, 73, 74], "beyond": 61, "wors": 61, "device_typ": 62, "dist_init_method_typ": 62, "pg_backend": 62, "pg_timeout": 62, "1800": 62, "float32_matmul_precis": 62, "launch": [62, 108], "spmd": 62, "style": [62, 107], "against": 62, "30": 62, "determinist": 63, "pseudo": 63, "commonli": 63, "numpi": 63, "error": [63, 82, 85, 101], "warn": [63, 104], "nondeterminist": 63, "benchmark": 63, "disabl": 63, "set_deterministic_debug_mod": 63, "algorithm": 63, "count": 64, "dev": 64, "discuss": 64, "dispatch": 64, "505": 64, "torchvis": 64, "resnet18": 64, "randn": 64, "224": 64, "ftdm": 64, "flops_forward": 64, "deepcopi": [64, 107], "flop_count": 64, "flops_backward": 64, "abstractfilesystem": 65, "steps_before_flush": [66, 67, 69], "log_all_rank": [66, 67, 69], "async_writ": 66, "header": 66, "buffer": [66, 68, 107], "flush": [66, 67, 69], "23": [68, 72], "56": [68, 72], "close": [68, 72, 122], "json": 69, "stdout": 71, "line": 71, "treat": 71, "opaqu": 71, "consecut": 71, "practic": 71, "digit": 71, "decim": 71, "rule": 71, "round": [71, 73], "usual": 71, "982378": 71, "23112": 71, "payload": 71, "99123": 71, "18787": 71, "9824": 71, "2311": 71, "9912": 71, "1879": 71, "tracked_metr": 72, "trackedmetr": 72, "anomalylogg": 72, "extra": 72, "tmp": [72, 75], "tb_log": 72, "duplic": 72, "ignor": [72, 107], "microsecond": [73, 74], "100000": [73, 74, 75], "rss": [73, 74], "baselin": [73, 74], "rss_deltas_byt": 73, "100m": 73, "byte": [73, 74, 78], "rss_delta": 74, "output_dir": [75, 82, 86], "memory_snapshot_param": 75, "memorysnapshotparam": 75, "histori": 75, "dump": 75, "offlin": 75, "stai": 75, "constant": 75, "account": 75, "start_step": 75, "neg": 75, "stop_step": 75, "greater": [75, 79], "nor": 75, "enable_oom_observ": 75, "src_modul": 77, "dst_modul": 77, "transfer": 77, "statist": [77, 107], "submodul": [78, 79], "trainabl": 78, "estim": [78, 96, 97, 98], "uniniti": 78, "shape": 78, "elaps": [78, 113, 121], "ms": 78, "module_arg": 79, "module_kwarg": 79, "modulesummari": [79, 80, 81], "assign": 79, "tree": [79, 81], "summar": 79, "lazi": 79, "NOT": 79, "todo": 79, "flexibl": [79, 107], "human_readable_num": 80, "summary_t": 80, "tabular": [80, 117], "exact": 80, "1234": 80, "k": 80, "prune": 81, "deeper": 81, "prun": 81, "inplac": 81, "trace_max_entri": 82, "1000000": 82, "attach": 82, "blog": [82, 86], "post": [82, 86], "due": 85, "file_prefix": 86, "prefix": 86, "memory_snapshot": 86, "necessari": [87, 105], "becaus": [87, 105], "adamw": 87, "lazili": 87, "solut": 87, "invalid": [88, 91], "output_devic": 89, "dim": 89, "bucket_cap_mb": 89, "25": 89, "find_unused_paramet": [89, 92], "gradient_as_bucket_view": [89, 92], "static_graph": 89, "comm_stat": 89, "comm_hook": 89, "gradbucket": 89, "futur": 89, "sync_batchnorm": 89, "regist": 89, "sharding_strategi": 90, "shardingstrategi": 90, "cpu_offload": 90, "cpuoffload": 90, "auto_wrap_polici": 90, "backward_prefetch": 90, "backwardprefetch": 90, "backward_pr": 90, "mixed_precis": 90, "mixedprecis": 90, "ignored_modul": 90, "param_init_fn": 90, "sync_module_st": 90, "use_orig_param": 90, "state_dict_config": 90, "statedictconfig": 90, "optim_state_dict_config": 90, "optimstatedictconfig": 90, "noopstrategi": 91, "materi": 92, "api": [92, 93, 105], "ddp_modul": 92, "fsdp_modul": 93, "activationcheckpointparam": 94, "noop": 94, "num_epochs_complet": [95, 123], "num_steps_completed_in_epoch": 95, "load_state_dict": 95, "remain": 96, "eval_every_n_step": 97, "eval_every_n_epoch": 97, "couldn": [97, 98], "critic": 99, "info": 102, "stateful_obj": 105, "fsdpoptimizerwrapp": 105, "load_checkpoint": 105, "use_buff": 107, "averaging_method": 107, "ema": 107, "ema_decai": 107, "999": 107, "skip_deepcopi": 107, "use_lit": 107, "streamlin": 107, "give": 107, "compat": 107, "swa_util": 107, "l66": 107, "entail": 107, "exponenti": 107, "decai": 107, "somewai": 107, "lit": 107, "adjust": 107, "small": 107, "approach": 107, "nproc": 108, "launchconfig": 108, "pet": 108, "launch_config": 108, "elastic_launch": 108, "interpret": [109, 110], "asan": [109, 111], "tsan": 110, "func": 111, "lower_bound": 112, "upper_bound": 112, "recorded_dur": [112, 114, 115, 116, 118], "size_bound": 112, "lower": 112, "upper": 112, "bound": 112, "smaller": 112, "remov": 112, "action": [112, 116, 118, 119, 120], "cuda_sync": [112, 114, 121], "verbos": [112, 114], "incur": [112, 114], "hit": [112, 114], "cpu_pg": 113, "propag": 113, "previou": 113, "block": 113, "percentil": [116, 118, 119], "sequenc": [116, 118, 119], "whose": 119, "action_nam": 121, "progress_bar": [122, 124], "tqdm_asyncio": [122, 123, 124], "desc": 123, "far": 123, "he": 123, "reflect": 124, "runtim": [125, 126], "Is": 127}, "objects": {"torchtnt.framework.auto_unit": [[3, 0, 1, "", "AutoPredictUnit"], [3, 0, 1, "", "AutoUnit"]], "torchtnt.framework.auto_unit.AutoPredictUnit": [[3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "predict_step"]], "torchtnt.framework.auto_unit.AutoUnit": [[3, 1, 1, "", "compute_loss"], [3, 1, 1, "", "configure_optimizers_and_lr_scheduler"], [3, 1, 1, "", "eval_step"], [3, 1, 1, "", "get_next_eval_batch"], [3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "get_next_train_batch"], [3, 1, 1, "", "on_eval_step_end"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "on_train_epoch_end"], [3, 1, 1, "", "on_train_step_end"], [3, 1, 1, "", "predict_step"], [3, 1, 1, "", "step_lr_scheduler"], [3, 1, 1, "", "train_step"], [3, 1, 1, "", "zero_grad"]], "torchtnt.framework": [[4, 2, 0, "-", "callback"]], "torchtnt.framework.callback": [[4, 0, 1, "", "Callback"]], "torchtnt.framework.callback.Callback": [[4, 3, 1, "", "name"], [4, 1, 1, "", "on_eval_dataloader_iter_creation_end"], [4, 1, 1, "", "on_eval_dataloader_iter_creation_start"], [4, 1, 1, "", "on_eval_end"], [4, 1, 1, "", "on_eval_epoch_end"], [4, 1, 1, "", "on_eval_epoch_start"], [4, 1, 1, "", "on_eval_get_next_batch_end"], [4, 1, 1, "", "on_eval_get_next_batch_start"], [4, 1, 1, "", "on_eval_start"], [4, 1, 1, "", "on_eval_step_end"], [4, 1, 1, "", "on_eval_step_start"], [4, 1, 1, "", "on_exception"], [4, 1, 1, "", "on_predict_dataloader_iter_creation_end"], [4, 1, 1, "", "on_predict_dataloader_iter_creation_start"], [4, 1, 1, "", "on_predict_end"], [4, 1, 1, "", "on_predict_epoch_end"], [4, 1, 1, "", "on_predict_epoch_start"], [4, 1, 1, "", "on_predict_get_next_batch_end"], [4, 1, 1, "", "on_predict_get_next_batch_start"], [4, 1, 1, "", "on_predict_start"], [4, 1, 1, "", "on_predict_step_end"], [4, 1, 1, "", "on_predict_step_start"], [4, 1, 1, "", "on_train_dataloader_iter_creation_end"], [4, 1, 1, "", "on_train_dataloader_iter_creation_start"], [4, 1, 1, "", "on_train_end"], [4, 1, 1, "", "on_train_epoch_end"], [4, 1, 1, "", "on_train_epoch_start"], [4, 1, 1, "", "on_train_get_next_batch_end"], [4, 1, 1, "", "on_train_get_next_batch_start"], [4, 1, 1, "", "on_train_start"], [4, 1, 1, "", "on_train_step_end"], [4, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks": [[7, 0, 1, "", "BaseCSVWriter"], [8, 0, 1, "", "EarlyStopping"], [9, 0, 1, "", "GarbageCollector"], [10, 0, 1, "", "IterationTimeLogger"], [11, 0, 1, "", "Lambda"], [12, 0, 1, "", "LearningRateMonitor"], [13, 0, 1, "", "MemorySnapshot"], [14, 0, 1, "", "ModuleSummary"], [15, 0, 1, "", "PeriodicDistributedSync"], [16, 0, 1, "", "ProgressReporter"], [17, 0, 1, "", "PyTorchProfiler"], [18, 0, 1, "", "SlowRankDetector"], [19, 0, 1, "", "SystemResourcesMonitor"], [20, 0, 1, "", "TQDMProgressBar"], [21, 0, 1, "", "TensorBoardParameterMonitor"], [22, 0, 1, "", "ThroughputLogger"], [23, 0, 1, "", "TimeLimitInterrupter"], [24, 0, 1, "", "TimeWaitForBatchLogger"], [25, 0, 1, "", "TorchSnapshotSaver"], [26, 0, 1, "", "TrainProgressMonitor"]], "torchtnt.framework.callbacks.BaseCSVWriter": [[7, 1, 1, "", "on_exception"], [7, 1, 1, "", "on_predict_end"], [7, 1, 1, "", "on_predict_start"], [7, 1, 1, "", "on_predict_step_end"]], "torchtnt.framework.callbacks.EarlyStopping": [[8, 1, 1, "", "on_eval_epoch_end"], [8, 1, 1, "", "on_eval_step_end"], [8, 1, 1, "", "on_train_epoch_end"], [8, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.GarbageCollector": [[9, 1, 1, "", "on_eval_end"], [9, 1, 1, "", "on_eval_start"], [9, 1, 1, "", "on_eval_step_end"], [9, 1, 1, "", "on_predict_end"], [9, 1, 1, "", "on_predict_start"], [9, 1, 1, "", "on_predict_step_end"], [9, 1, 1, "", "on_train_end"], [9, 1, 1, "", "on_train_start"], [9, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.IterationTimeLogger": [[10, 1, 1, "", "on_eval_end"], [10, 1, 1, "", "on_eval_step_end"], [10, 1, 1, "", "on_predict_end"], [10, 1, 1, "", "on_predict_step_end"], [10, 1, 1, "", "on_train_end"], [10, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.LearningRateMonitor": [[12, 1, 1, "", "on_train_epoch_start"], [12, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.MemorySnapshot": [[13, 1, 1, "", "on_eval_step_end"], [13, 1, 1, "", "on_predict_step_end"], [13, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.ModuleSummary": [[14, 1, 1, "", "on_eval_start"], [14, 1, 1, "", "on_predict_start"], [14, 1, 1, "", "on_train_start"]], "torchtnt.framework.callbacks.PeriodicDistributedSync": [[15, 1, 1, "", "on_eval_step_end"], [15, 1, 1, "", "on_predict_step_end"]], "torchtnt.framework.callbacks.ProgressReporter": [[16, 1, 1, "", "on_eval_end"], [16, 1, 1, "", "on_eval_epoch_end"], [16, 1, 1, "", "on_eval_epoch_start"], [16, 1, 1, "", "on_eval_start"], [16, 1, 1, "", "on_eval_step_end"], [16, 1, 1, "", "on_eval_step_start"], [16, 1, 1, "", "on_predict_end"], [16, 1, 1, "", "on_predict_epoch_end"], [16, 1, 1, "", "on_predict_epoch_start"], [16, 1, 1, "", "on_predict_start"], [16, 1, 1, "", "on_predict_step_end"], [16, 1, 1, "", "on_predict_step_start"], [16, 1, 1, "", "on_train_end"], [16, 1, 1, "", "on_train_epoch_end"], [16, 1, 1, "", "on_train_epoch_start"], [16, 1, 1, "", "on_train_start"], [16, 1, 1, "", "on_train_step_end"], [16, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.PyTorchProfiler": [[17, 1, 1, "", "on_eval_end"], [17, 1, 1, "", "on_eval_start"], [17, 1, 1, "", "on_eval_step_end"], [17, 1, 1, "", "on_predict_end"], [17, 1, 1, "", "on_predict_start"], [17, 1, 1, "", "on_predict_step_end"], [17, 1, 1, "", "on_train_end"], [17, 1, 1, "", "on_train_start"], [17, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SlowRankDetector": [[18, 1, 1, "", "on_train_epoch_end"], [18, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SystemResourcesMonitor": [[19, 1, 1, "", "on_eval_epoch_start"], [19, 1, 1, "", "on_eval_step_start"], [19, 1, 1, "", "on_predict_epoch_start"], [19, 1, 1, "", "on_predict_step_start"], [19, 1, 1, "", "on_train_epoch_start"], [19, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.TQDMProgressBar": [[20, 1, 1, "", "on_eval_epoch_end"], [20, 1, 1, "", "on_eval_epoch_start"], [20, 1, 1, "", "on_eval_step_end"], [20, 1, 1, "", "on_predict_epoch_end"], [20, 1, 1, "", "on_predict_epoch_start"], [20, 1, 1, "", "on_predict_step_end"], [20, 1, 1, "", "on_train_epoch_end"], [20, 1, 1, "", "on_train_epoch_start"], [20, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TensorBoardParameterMonitor": [[21, 1, 1, "", "on_train_epoch_end"]], "torchtnt.framework.callbacks.ThroughputLogger": [[22, 1, 1, "", "on_eval_end"], [22, 1, 1, "", "on_eval_start"], [22, 1, 1, "", "on_eval_step_end"], [22, 1, 1, "", "on_predict_end"], [22, 1, 1, "", "on_predict_start"], [22, 1, 1, "", "on_predict_step_end"], [22, 1, 1, "", "on_train_end"], [22, 1, 1, "", "on_train_epoch_end"], [22, 1, 1, "", "on_train_epoch_start"], [22, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TimeLimitInterrupter": [[23, 1, 1, "", "on_train_epoch_end"], [23, 1, 1, "", "on_train_start"], [23, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TimeWaitForBatchLogger": [[24, 1, 1, "", "on_eval_step_end"], [24, 1, 1, "", "on_predict_step_end"], [24, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TorchSnapshotSaver": [[25, 1, 1, "", "on_exception"], [25, 1, 1, "", "on_train_start"], [25, 1, 1, "", "restore"]], "torchtnt.framework.callbacks.TrainProgressMonitor": [[26, 1, 1, "", "on_train_epoch_end"], [26, 1, 1, "", "on_train_start"]], "torchtnt.framework.evaluate": [[5, 4, 1, "", "evaluate"]], "torchtnt.framework.fit": [[6, 4, 1, "", "fit"]], "torchtnt.framework.predict": [[27, 4, 1, "", "predict"]], "torchtnt.framework.state": [[28, 0, 1, "", "PhaseState"], [28, 0, 1, "", "State"]], "torchtnt.framework.state.PhaseState": [[28, 3, 1, "", "dataloader"], [28, 3, 1, "", "evaluate_every_n_epochs"], [28, 3, 1, "", "evaluate_every_n_steps"], [28, 3, 1, "", "iteration_timer"], [28, 3, 1, "", "max_epochs"], [28, 3, 1, "", "max_steps"], [28, 3, 1, "", "max_steps_per_epoch"], [28, 3, 1, "", "step_output"]], "torchtnt.framework.state.State": [[28, 3, 1, "", "active_phase"], [28, 1, 1, "", "active_phase_state"], [28, 3, 1, "", "entry_point"], [28, 3, 1, "", "eval_state"], [28, 3, 1, "", "predict_state"], [28, 3, 1, "", "should_stop"], [28, 1, 1, "", "stop"], [28, 3, 1, "", "timer"], [28, 3, 1, "", "train_state"]], "torchtnt.framework.train": [[29, 4, 1, "", "train"]], "torchtnt.framework.unit": [[30, 0, 1, "", "EvalUnit"], [30, 0, 1, "", "PredictUnit"], [30, 0, 1, "", "TrainUnit"]], "torchtnt.framework.unit.EvalUnit": [[30, 1, 1, "", "eval_step"], [30, 1, 1, "", "get_next_eval_batch"], [30, 1, 1, "", "on_checkpoint_save"], [30, 1, 1, "", "on_eval_end"], [30, 1, 1, "", "on_eval_epoch_end"], [30, 1, 1, "", "on_eval_epoch_start"], [30, 1, 1, "", "on_eval_start"]], "torchtnt.framework.unit.PredictUnit": [[30, 1, 1, "", "get_next_predict_batch"], [30, 1, 1, "", "on_checkpoint_save"], [30, 1, 1, "", "on_predict_end"], [30, 1, 1, "", "on_predict_epoch_end"], [30, 1, 1, "", "on_predict_epoch_start"], [30, 1, 1, "", "on_predict_start"], [30, 1, 1, "", "predict_step"]], "torchtnt.framework.unit.TrainUnit": [[30, 1, 1, "", "get_next_train_batch"], [30, 1, 1, "", "on_checkpoint_save"], [30, 1, 1, "", "on_train_end"], [30, 1, 1, "", "on_train_epoch_end"], [30, 1, 1, "", "on_train_epoch_start"], [30, 1, 1, "", "on_train_start"], [30, 1, 1, "", "train_step"]], "torchtnt.utils.data": [[33, 0, 1, "", "AbstractRandomDataset"], [34, 0, 1, "", "AllDatasetBatchesIterator"], [35, 0, 1, "", "CudaDataPrefetcher"], [36, 0, 1, "", "InOrderIterator"], [37, 0, 1, "", "MultiDataLoader"], [38, 0, 1, "", "MultiIterator"], [39, 0, 1, "", "RandomizedBatchSamplerIterator"], [40, 0, 1, "", "RoundRobinIterator"]], "torchtnt.utils.data.AbstractRandomDataset": [[33, 1, 1, "", "__init__"], [33, 5, 1, "", "size"]], "torchtnt.utils.data.AllDatasetBatchesIterator": [[34, 1, 1, "", "__init__"]], "torchtnt.utils.data.CudaDataPrefetcher": [[35, 1, 1, "", "__init__"]], "torchtnt.utils.data.InOrderIterator": [[36, 1, 1, "", "__init__"]], "torchtnt.utils.data.MultiDataLoader": [[37, 1, 1, "", "__init__"], [37, 5, 1, "", "ignore_empty_data"], [37, 5, 1, "", "individual_dataloaders"], [37, 5, 1, "", "iteration_strategy"], [37, 5, 1, "", "iterator_cls"]], "torchtnt.utils.data.MultiIterator": [[38, 1, 1, "", "__init__"]], "torchtnt.utils.data.RandomizedBatchSamplerIterator": [[39, 1, 1, "", "__init__"]], "torchtnt.utils.data.RoundRobinIterator": [[40, 1, 1, "", "__init__"]], "torchtnt.utils.device": [[41, 4, 1, "", "copy_data_to_device"], [42, 4, 1, "", "get_device_from_env"], [43, 4, 1, "", "get_nvidia_smi_gpu_stats"], [44, 4, 1, "", "get_psutil_cpu_stats"], [45, 4, 1, "", "record_data_in_stream"], [46, 4, 1, "", "set_float32_precision"]], "torchtnt.utils.distributed": [[47, 0, 1, "", "PGWrapper"], [48, 4, 1, "", "all_gather_tensors"], [49, 4, 1, "", "barrier"], [50, 4, 1, "", "destroy_process_group"], [51, 4, 1, "", "get_file_init_method"], [52, 4, 1, "", "get_global_rank"], [53, 4, 1, "", "get_local_rank"], [54, 4, 1, "", "get_process_group_backend_from_device"], [55, 4, 1, "", "get_tcp_init_method"], [56, 4, 1, "", "get_world_size"], [57, 4, 1, "", "rank_zero_fn"], [58, 4, 1, "", "revert_sync_batchnorm"], [59, 4, 1, "", "spawn_multi_process"], [60, 4, 1, "", "sync_bool"]], "torchtnt.utils.distributed.PGWrapper": [[47, 1, 1, "", "__init__"]], "torchtnt.utils.early_stop_checker": [[61, 0, 1, "", "EarlyStopChecker"]], "torchtnt.utils.early_stop_checker.EarlyStopChecker": [[61, 1, 1, "", "__init__"]], "torchtnt.utils.env": [[62, 4, 1, "", "init_from_env"], [63, 4, 1, "", "seed"]], "torchtnt.utils.flops": [[64, 0, 1, "", "FlopTensorDispatchMode"]], "torchtnt.utils.flops.FlopTensorDispatchMode": [[64, 1, 1, "", "__init__"]], "torchtnt.utils.fsspec": [[65, 4, 1, "", "get_filesystem"]], "torchtnt.utils.loggers": [[66, 0, 1, "", "CSVLogger"], [67, 0, 1, "", "FileLogger"], [68, 0, 1, "", "InMemoryLogger"], [69, 0, 1, "", "JSONLogger"], [70, 0, 1, "", "MetricLogger"], [71, 0, 1, "", "StdoutLogger"], [72, 0, 1, "", "TensorBoardLogger"]], "torchtnt.utils.loggers.CSVLogger": [[66, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.FileLogger": [[67, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.InMemoryLogger": [[68, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.JSONLogger": [[69, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.MetricLogger": [[70, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.StdoutLogger": [[71, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.TensorBoardLogger": [[72, 1, 1, "", "__init__"]], "torchtnt.utils.memory": [[73, 0, 1, "", "RSSProfiler"], [74, 4, 1, "", "measure_rss_deltas"]], "torchtnt.utils.memory.RSSProfiler": [[73, 1, 1, "", "__init__"], [73, 5, 1, "", "interval"], [73, 5, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.memory_snapshot_profiler": [[75, 0, 1, "", "MemorySnapshotProfiler"]], "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler": [[75, 1, 1, "", "__init__"]], "torchtnt.utils.misc": [[76, 4, 1, "", "days_to_secs"], [77, 4, 1, "", "transfer_batch_norm_stats"]], "torchtnt.utils.module_summary": [[78, 0, 1, "", "ModuleSummary"], [79, 4, 1, "", "get_module_summary"], [80, 4, 1, "", "get_summary_table"], [81, 4, 1, "", "prune_module_summary"]], "torchtnt.utils.module_summary.ModuleSummary": [[78, 1, 1, "", "__init__"]], "torchtnt.utils.oom": [[82, 4, 1, "", "attach_oom_observer"], [83, 4, 1, "", "is_out_of_cpu_memory"], [84, 4, 1, "", "is_out_of_cuda_memory"], [85, 4, 1, "", "is_out_of_memory_error"], [86, 4, 1, "", "log_memory_snapshot"]], "torchtnt.utils.optimizer": [[87, 4, 1, "", "init_optim_state"]], "torchtnt.utils.precision": [[88, 4, 1, "", "convert_precision_str_to_dtype"]], "torchtnt.utils.prepare_module": [[89, 0, 1, "", "DDPStrategy"], [90, 0, 1, "", "FSDPStrategy"], [91, 4, 1, "", "convert_str_to_strategy"], [92, 4, 1, "", "prepare_ddp"], [93, 4, 1, "", "prepare_fsdp"], [94, 4, 1, "", "prepare_module"]], "torchtnt.utils.prepare_module.DDPStrategy": [[89, 1, 1, "", "__init__"]], "torchtnt.utils.prepare_module.FSDPStrategy": [[90, 1, 1, "", "__init__"]], "torchtnt.utils.progress": [[95, 0, 1, "", "Progress"], [96, 4, 1, "", "estimated_steps_in_epoch"], [97, 4, 1, "", "estimated_steps_in_fit"], [98, 4, 1, "", "estimated_steps_in_loop"]], "torchtnt.utils.progress.Progress": [[95, 1, 1, "", "__init__"]], "torchtnt.utils.rank_zero_log": [[99, 4, 1, "", "rank_zero_critical"], [100, 4, 1, "", "rank_zero_debug"], [101, 4, 1, "", "rank_zero_error"], [102, 4, 1, "", "rank_zero_info"], [103, 4, 1, "", "rank_zero_print"], [104, 4, 1, "", "rank_zero_warn"]], "torchtnt.utils.stateful": [[105, 0, 1, "", "MultiStateful"], [106, 0, 1, "", "Stateful"]], "torchtnt.utils.stateful.MultiStateful": [[105, 1, 1, "", "__init__"]], "torchtnt.utils.stateful.Stateful": [[106, 1, 1, "", "__init__"]], "torchtnt.utils.swa": [[107, 0, 1, "", "AveragedModel"]], "torchtnt.utils.swa.AveragedModel": [[107, 1, 1, "", "__init__"]], "torchtnt.utils.test_utils": [[108, 4, 1, "", "get_pet_launch_config"], [109, 4, 1, "", "is_asan"], [110, 4, 1, "", "is_tsan"], [111, 4, 1, "", "skip_if_asan"]], "torchtnt.utils.timer": [[112, 0, 1, "", "BoundedTimer"], [113, 0, 1, "", "FullSyncPeriodicTimer"], [114, 0, 1, "", "Timer"], [115, 0, 1, "", "TimerProtocol"], [116, 4, 1, "", "get_durations_histogram"], [117, 4, 1, "", "get_recorded_durations_table"], [118, 4, 1, "", "get_synced_durations_histogram"], [119, 4, 1, "", "get_synced_timer_histogram"], [120, 4, 1, "", "get_timer_summary"], [121, 4, 1, "", "log_elapsed_time"]], "torchtnt.utils.timer.BoundedTimer": [[112, 1, 1, "", "__init__"]], "torchtnt.utils.timer.FullSyncPeriodicTimer": [[113, 1, 1, "", "__init__"]], "torchtnt.utils.timer.Timer": [[114, 1, 1, "", "__init__"]], "torchtnt.utils.timer.TimerProtocol": [[115, 1, 1, "", "__init__"]], "torchtnt.utils.tqdm": [[122, 4, 1, "", "close_progress_bar"], [123, 4, 1, "", "create_progress_bar"], [124, 4, 1, "", "update_progress_bar"]], "torchtnt.utils.version": [[125, 4, 1, "", "get_python_version"], [126, 4, 1, "", "get_torch_version"], [127, 4, 1, "", "is_windows"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:module", "3": "py:property", "4": "py:function", "5": "py:attribute"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "module", "Python module"], "3": ["py", "property", "Python property"], "4": ["py", "function", "Python function"], "5": ["py", "attribute", "Python attribute"]}, "titleterms": {"checkpoint": 0, "fulli": [0, 1], "shard": [0, 1], "data": [0, 1, 33, 34, 35, 36, 37, 38, 39, 40, 128], "parallel": [0, 1], "finetun": 0, "best": 0, "model": [0, 32], "metric": 0, "distribut": [1, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 128], "train": [1, 2, 29, 32], "exampl": [2, 31], "trainunit": [2, 30], "autounit": [2, 3], "torchdata": 2, "mnist": 2, "mingpt": 2, "torchrec": 2, "callback": [4, 32], "built": 4, "evalu": 5, "entri": [5, 6, 27, 29], "point": [5, 6, 27, 29], "fit": 6, "basecsvwrit": 7, "earlystop": 8, "garbagecollector": 9, "iterationtimelogg": 10, "lambda": 11, "learningratemonitor": 12, "memorysnapshot": 13, "modulesummari": [14, 78], "periodicdistributedsync": 15, "progressreport": 16, "pytorchprofil": 17, "slowrankdetector": 18, "systemresourcesmonitor": 19, "tqdmprogressbar": 20, "tensorboardparametermonitor": 21, "throughputlogg": 22, "timelimitinterrupt": 23, "timewaitforbatchlogg": 24, "torchsnapshotsav": 25, "trainprogressmonitor": 26, "predict": 27, "state": [28, 105, 106, 128], "phasest": 28, "unit": 30, "evalunit": 30, "predictunit": 30, "combin": 30, "multipl": 30, "welcom": 31, "torchtnt": [31, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127], "document": 31, "instal": 31, "overview": [31, 32], "core": [31, 32], "concept": 31, "framework": [31, 32], "util": [31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128], "function": 32, "api": 32, "organ": 32, "your": 32, "code": 32, "abstractrandomdataset": 33, "alldatasetbatchesiter": 34, "cudadataprefetch": 35, "inorderiter": 36, "multidataload": 37, "multiiter": 38, "randomizedbatchsampleriter": 39, "roundrobiniter": 40, "devic": [41, 42, 43, 44, 45, 46, 128], "copy_data_to_devic": 41, "get_device_from_env": 42, "get_nvidia_smi_gpu_stat": 43, "get_psutil_cpu_stat": 44, "record_data_in_stream": 45, "set_float32_precis": 46, "pgwrapper": 47, "all_gather_tensor": 48, "barrier": 49, "destroy_process_group": 50, "get_file_init_method": 51, "get_global_rank": 52, "get_local_rank": 53, "get_process_group_backend_from_devic": 54, "get_tcp_init_method": 55, "get_world_s": 56, "rank_zero_fn": 57, "revert_sync_batchnorm": 58, "spawn_multi_process": 59, "sync_bool": 60, "early_stop_check": 61, "earlystopcheck": 61, "env": [62, 63], "init_from_env": 62, "seed": 63, "flop": [64, 128], "floptensordispatchmod": 64, "fsspec": 65, "get_filesystem": 65, "logger": [66, 67, 68, 69, 70, 71, 72, 128], "csvlogger": 66, "filelogg": 67, "inmemorylogg": 68, "jsonlogg": 69, "metriclogg": 70, "stdoutlogg": 71, "tensorboardlogg": 72, "memori": [73, 74, 128], "rssprofil": 73, "measure_rss_delta": 74, "memory_snapshot_profil": 75, "memorysnapshotprofil": [75, 128], "misc": [76, 77, 128], "days_to_sec": 76, "transfer_batch_norm_stat": 77, "module_summari": [78, 79, 80, 81], "get_module_summari": 79, "get_summary_t": 80, "prune_module_summari": 81, "oom": [82, 83, 84, 85, 86, 128], "attach_oom_observ": 82, "is_out_of_cpu_memori": 83, "is_out_of_cuda_memori": 84, "is_out_of_memory_error": 85, "log_memory_snapshot": 86, "optim": [87, 128], "init_optim_st": 87, "precis": [88, 128], "convert_precision_str_to_dtyp": 88, "prepare_modul": [89, 90, 91, 92, 93, 94], "ddpstrategi": 89, "fsdpstrategi": 90, "convert_str_to_strategi": 91, "prepare_ddp": 92, "prepare_fsdp": 93, "progress": [95, 96, 97, 98, 128], "estimated_steps_in_epoch": 96, "estimated_steps_in_fit": 97, "estimated_steps_in_loop": 98, "rank_zero_log": [99, 100, 101, 102, 103, 104], "rank_zero_crit": 99, "rank_zero_debug": 100, "rank_zero_error": 101, "rank_zero_info": 102, "rank_zero_print": 103, "rank_zero_warn": 104, "multist": 105, "swa": [107, 128], "averagedmodel": 107, "test_util": [108, 109, 110, 111], "get_pet_launch_config": 108, "is_asan": 109, "is_tsan": 110, "skip_if_asan": 111, "timer": [112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 128], "boundedtim": 112, "fullsyncperiodictim": 113, "timerprotocol": 115, "get_durations_histogram": 116, "get_recorded_durations_t": 117, "get_synced_durations_histogram": 118, "get_synced_timer_histogram": 119, "get_timer_summari": 120, "log_elapsed_tim": 121, "tqdm": [122, 123, 124, 128], "close_progress_bar": 122, "create_progress_bar": 123, "update_progress_bar": 124, "version": [125, 126, 127, 128], "get_python_vers": 125, "get_torch_vers": 126, "is_window": 127, "earli": 128, "stop": 128, "checker": 128, "environ": 128, "filesystem": 128, "spec": 128, "modul": 128, "summari": 128, "prepar": 128, "rank": 128, "zero": 128, "log": 128, "test": 128}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 56}})